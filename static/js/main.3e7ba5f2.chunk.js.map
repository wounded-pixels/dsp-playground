{"version":3,"sources":["components/stateless-helpers.tsx","content/About.tsx","components/CurveControl.tsx","model/SineCurve.ts","components/TimePlot.tsx","util/samples.ts","content/SimpleAddition.tsx","components/TopNav.tsx","util/math-hacks.ts","content/ConvolutionSteps/StepsPlot.tsx","content/ConvolutionSteps/ConvolutionSteps.tsx","content/Topics.tsx","components/FrequencyDomainControl.tsx","content/SumOfManySines.tsx","content/UnitCircleAndCurves/UnitCircleControl.tsx","content/UnitCircleAndCurves/AnnotatedCurveControl.tsx","content/UnitCircleAndCurves/UnitCircleAndCurves.tsx","content/SineOverTime.tsx","components/FrequencyDomainPlayer.tsx","content/SoundsFromSines.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["hintStyles","Hint","text","children","style","Tooltip","title","IconButton","aria-label","ContactSupport","fontSize","keyIdeaStyles","background","margin","padding","KeyIdea","rowStyles","alignItems","display","flexDirection","flexGrow","justifyContent","width","Row","className","contextStyles","paddingTop","Context","topicStyles","textAlign","Topic","Title","props","titleStyles","fontWeight","height","Symbol","symbolStyles","visualizationStyles","Visualization","scenarioLinkStyles","ScenarioLink","index","onClick","Link","RevealLink","ScrollToTopOnMount","window","scrollTo","React","Component","ZoomControl","current","min","max","onZoom","zoomButtonStyles","disabled","About","CurveControl","this","curveNumber","curveParameters","includePhase","createFloatInput","attribute","step","FormHelperText","Input","value","type","inputProps","onChange","_evt","parseFloat","target","amplitudeInput","frequencyInput","phaseInput","SineCurve","tStart","tEnd","samplingRate","amplitude","frequency","phase","pairs","time","pair","Math","sin","PI","push","TimePlot","domainX","values","length","rangeY","minY","map","v","maxY","adjustedSvgHeight","xTickValues","calculateDefaultTicks","yTickValues","viewBox","curvePath","calculateSvgX","calculateSvgY","horizontalGridLines","yValue","d","verticalGridLines","xValue","curve","inMilliseconds","timeLabel","bottomLabel","x","y","xLabels","adjustedXValue","yLabels","addSamples","sum","samples","col_index","sample_index","jaggedParameters","examples","beatParameters","flatParameters","SimpleAddition","state","onChangeCurveParameter","parameterName","setState","onExample","rawKey","key","cloneDeep","firstSample","sample","secondSample","combined","to","buildLink","labeledPath","path","label","TopNav","home","links","centerText","linkElements","round","raw","multiplier","clamp","snap","digits","createSignal","repetitions","lowestFrequency","cp","interval","dt","curveParameter","sinc","addZeroes","kernel","StepsPlot","timeIndex","signalAmplitudes","kernelAmplitudes","domainWidth","adjustedSvgWidth","section","plotAmplitude","iIndex","jIndex","outputSignalAmplitudes","signal","output","maxOutputIndex","outIndex","kernelIndex","signalIndex","convolve","signalLabel","calculateSvgSignalY","kernelLabel","calculateSvgKernelY","outputSignalLabel","calculateSvgOutputSignalY","signalAxisLabels","kernelAxisLabels","outputSignalAxisLabels","horizontalSignalGridLines","horizontalKernelGridLines","horizontalOutputSignalGridLines","diagonalLines","filter","line","showDecorations","signalCircles","cx","cy","r","kernelCircles","outputSignalCircles","productSum","reduce","total","currentOutputSignalCircle","crossCenterX","crossCenterY","multiplicationSign","crossRadius","x1","y1","x2","y2","linesToPlus","plusCenterX","plusCenterY","plusSign","plusRadius","lineToProductSum","shortSignal","longLength","longSignal","lowWithNoiseSignal","first","second","maxIndex","addSignals","mean","std","sampleIndex","random","sampleCount","createNoise","lowBackgroundSignal","sampleKernel","rawLowPassKernel","normalize","multiplySignals","cutoffFrequency","createLowPassKernel","cos","createBlackmanWindow","lowpassKernel","highpassKernel","spectralInvert","exampleKernels","flipKernel","derivativeKernel","delayKernel","exampleSignals","ConvolutionSteps","playing","onSelectKernel","onSelectSignal","incrementIndex","doPlay","setTimeout","togglePlay","incrementToEnd","signalValue","kernelValue","commentary","buildCommentary","productSpans","signalText","kernelText","symbol","signalSpanClass","kernelSpanClass","resultSummary","Topics","knobAllocation","knobDimensions","calculateKnobX","FrequencyDomainControl","svgRef","createRef","activeDragIndex","calculateKnobY","amplitudeValue","scale","maxAmplitude","minAmplitude","calculateAmplitudeFromY","adjustedY","calculateTooltipX","frequencyIndex","convertToPlotY","eventY","CTM","getScreenCTM","f","newY","evt","preventDefault","newAmplitude","startDrag","stopDrag","amplitudes","minFrequency","frequencies","maxFrequency","amplitudeLabels","knobs","onMove","convertedY","clientY","onTouch","touches","onMouseMove","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","onTouchMove","activeChangeDescription","ref","justOneFrequencies","oldBeatFrequencies","alternatingBeatFrequencies","clearFrequencies","flatBeatFrequencies","spikyFrequencies","twoFourSixFrequencies","inkFrequencies","SumOfManySines","zoomLevel","logMessage","increment","newZoom","sideLength","UnitCircleControl","activeDrag","newSvgX","newSvgY","newDomainX","calculateDomainX","newDomainY","calculateDomainY","piRatio","atan2","clientX","eventX","e","a","svgY","revealLevel","centerX","centerY","largeArc","xArcRadius","yArcRadius","horizontalLineEnd","verticalLineEnd","angleLabelDomainX","angleLabelRangeY","textAnchor","plotTitle","angleLabel","backgroundCircle","horizontalLine","verticalLine","radiusLine","verticalLineRangeY","horizontalDomainX","verticalLineLabel","abs","toFixed","horizontalLineLabel","foregroundArc","knob","triangle","Fragment","AnnotatedCurveControl","rangeMaximum","yFunction","horizontalLineBegin","verticalLineStart","verticalStrokeColor","angle","angleLabelVerticalOffset","stroke","verticalLineValue","fill","clampPiRatio","clamped","UnitCircleAndCurves","onChangePiRatio","setReveal","SineOverTime","FrequencyDomainPlayer","audioCtx","AudioContext","webkitAudioContext","oscillators","amplitudeNodes","mergeGainNode","createGain","togglePlayer","start","ctr","oscillator","createOscillator","setValueAtTime","currentTime","amplitudeNode","gain","connect","destination","balancedGain","forEach","node","harmonicFrequencies","buzzFrequencies","buzzierFrequencies","SoundsFromSines","navProps","App","basename","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3e7ba5f2.chunk.js","sourcesContent":["import React, { FunctionComponent, CSSProperties } from 'react';\n\nimport {IconButton, Link, Tooltip} from '@material-ui/core';\nimport {ContactSupport} from '@material-ui/icons';\n\ntype HintProps = {text: string};\nconst hintStyles: CSSProperties = {};\nexport const Hint: FunctionComponent<HintProps> = ({text, children}) => {\n    return (\n        <div style={hintStyles}>\n            {children}\n            <Tooltip title={text}>\n                <IconButton aria-label=\"hint\">\n                    <ContactSupport fontSize=\"small\"/>\n                </IconButton>\n            </Tooltip>\n        </div>\n    );\n};\n\ntype KeyIdeaProps = {};\nconst keyIdeaStyles: CSSProperties = {\n    background: '#f6ebb0',\n    margin: '10px 0',\n    padding: '5px 0',\n};\nexport const KeyIdea: FunctionComponent<KeyIdeaProps> = ({children}) => {\n    return (\n        <div style={keyIdeaStyles}>\n            {children}\n        </div>\n    );\n};\n\ntype RowProps = {};\nconst rowStyles: CSSProperties = {\n    alignItems: 'center',\n    display: 'flex',\n    flexDirection: 'row',\n    flexGrow: 0,\n    justifyContent: 'start',\n    width: '100%',\n};\nexport const Row: FunctionComponent<RowProps> = ({children}) => {\n    return (\n        <div className=\"Row\" style={rowStyles}>\n            {children}\n        </div>\n    );\n};\n\ntype ContextProps = {};\nconst contextStyles: CSSProperties = {\n    paddingTop: '8px',\n};\nexport const Context: FunctionComponent<ContextProps> = ({children}) => {\n    return (\n    <div style={contextStyles}>\n    {children}\n    </div>\n    );\n};\n\ntype TopicProps = {\n    className?: string;\n};\n\nconst topicStyles: CSSProperties = {\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 2,\n    paddingTop: '10px',\n    textAlign: 'left',\n    width: '85%',\n};\nexport const Topic: FunctionComponent<TopicProps> = ({className, children}) => {\n    return (\n      <div className={className} style={topicStyles}>\n          {children}\n      </div>\n    );\n};\n\ntype TitleProps = {\n    width: string;\n};\n\nexport const Title: FunctionComponent<TitleProps> = (props) => {\n    const titleStyles: CSSProperties = {\n        display: 'flex',\n        fontSize: '18px',\n        fontWeight: 'bold',\n        textAlign: 'center',\n        justifyContent: 'center',\n        width: props.width,\n        height: '18px',\n    };\n\n    return (\n        <div style={titleStyles}>\n            {props.children}\n        </div>\n    );\n};\n\ntype SymbolProps = {\n    width: string;\n};\n\nexport const Symbol: FunctionComponent<SymbolProps> = (props) => {\n    const symbolStyles: CSSProperties = {\n        display: 'flex',\n        fontSize: '32px',\n        fontWeight: 'bold',\n        textAlign: 'center',\n        justifyContent: 'center',\n        width: props.width,\n        height: '32px',\n    };\n\n    return (\n      <div style={symbolStyles}>\n          {props.children}\n      </div>\n    );\n};\n\ntype VisualizationProps = {};\nconst visualizationStyles: CSSProperties = {\n    padding: '10px 10px',\n};\nexport const Visualization: FunctionComponent<VisualizationProps> = ({children}) => {\n    return (\n      <div style={visualizationStyles}>\n          {children}\n      </div>\n    );\n};\n\ntype ScenarioLinkProps = {\n    index: string,\n    onClick: (index: string) => void;\n};\nconst scenarioLinkStyles: CSSProperties = {\n    margin: '0px 0px',\n};\nexport const ScenarioLink: FunctionComponent<ScenarioLinkProps> = ({index, onClick, children}) => {\n    return (\n      <span style={scenarioLinkStyles}>\n          <Link onClick={() => {\n              onClick(index)\n          }} > {children} </Link>\n      </span>\n    );\n};\n\ntype RevealLinkProps = {\n    onClick: any;\n};\nexport const RevealLink: FunctionComponent<RevealLinkProps> = ({onClick, children}) => {\n    return (\n        <span>\n          &nbsp;\n            <Link onClick={onClick}> {children} </Link>\n      </span>\n    );\n};\n\nexport class ScrollToTopOnMount extends React.Component {\n  componentDidMount() {\n      window.scrollTo(0,0);\n  }\n\n  render() {\n      return null;\n  }\n}\n\ntype ZoomControlProps = {\n    current: number;\n    min: number;\n    max: number;\n    onZoom: (increment: number) => void;\n};\nexport const ZoomControl: FunctionComponent<ZoomControlProps> = ({current, min, max, onZoom}) => {\n    const zoomDivStyles: CSSProperties = {\n        margin: '0 10px',\n    };\n    const zoomButtonStyles: CSSProperties = {\n      margin: '0 2px',\n    };\n\n    return (\n        <div style={zoomDivStyles}>\n            <button style={zoomButtonStyles} disabled={current === min} onClick={() => onZoom(-1)}>Zoom In</button>\n            <button style={zoomButtonStyles} disabled={current === max} onClick={() => onZoom(1)}>Zoom Out</button>\n        </div>\n    );\n};\n\n\n","import React, { FunctionComponent } from 'react';\nimport {Context, Topic} from 'components/stateless-helpers';\n\ntype Props = {};\nconst About: FunctionComponent<Props> = () => {\n    return (\n        <Topic>\n            <h2>About</h2>\n            <Context>\n                I believe that people learn by tinkering, exploring, breaking and re-assembling\n                things. For most of us the math is only valuable to nail down the details after we see\n                where things are headed. So, pretty much every page of this site has dials, sliders or gizmos\n                that drive the visualizations. Tinker away!\n            </Context>\n            <h3>Goals</h3>\n            <Context>\n                Digital Signal Processing (DSP) can be a very daunting topic - lots of math and some pretty arcane terminology.\n                It is also a ridiculously powerful foundation for a lot of very powerful technology.\n                DSP is very much worth your time and effort. I hope this playground helps you build some intellectual momentum\n                as you learn it.\n            </Context>\n            <h3>Who</h3>\n            <Context>\n                I am a software developer who works around DSP and finds it fascinating. I also really enjoy building\n                visualizations. This site is my way of deepening my own understanding and (hopefully) giving a little\n                bit back to the community.\n            </Context>\n        </Topic>\n    );\n};\n\nexport default About;\n","import React, {Component} from 'react';\n\nimport {FormHelperText, Input} from '@material-ui/core';\n\nimport {CurveParameters} from 'model/types';\n\nimport './CurveControl.scss';\n\ntype Props = {\n    curveNumber: number;\n    curveParameters: CurveParameters;\n    includePhase?: boolean | undefined;\n    onChange: (curveNumber: number, parameterName: 'amplitude' | 'frequency' | 'phase', value: number) => void;\n};\n\nclass CurveControl extends Component<Props> {\n    render(): JSX.Element {\n        const { curveNumber, curveParameters, includePhase } = this.props;\n\n        const createFloatInput = (attribute: 'amplitude' | 'frequency' | 'phase', min: number, max: number, step:number) => {\n          return (\n              <div className=\"float-input\">\n                  <FormHelperText>{attribute}</FormHelperText>\n                  <Input\n                      value={curveParameters[attribute]}\n                      type=\"number\"\n                      inputProps={{\n                          'step': step,\n                          'min': min,\n                          'max': max,\n                      }}\n                      onChange={(_evt) => {\n                          this.props.onChange(curveNumber, attribute, parseFloat(_evt.target.value));\n                      }}\n                  />\n              </div>\n          );\n        };\n\n        const amplitudeInput = createFloatInput('amplitude', -4, 4, 0.1);\n        const frequencyInput = createFloatInput('frequency', 0, 20, 0.1);\n        const phaseInput = includePhase ?\n            createFloatInput('phase', -1, 1, 0.1) :\n            null;\n\n        return (\n            <div className=\"CurveControl\">\n                {amplitudeInput}\n                {frequencyInput}\n                {phaseInput}\n            </div>\n        );\n    };\n}\n\nexport default CurveControl;\n","import {CurveParameters, Sample, TimeValue} from './types';\n\nclass SineCurve {\n    private readonly curveParameters: CurveParameters;\n\n    constructor(curveParameters: CurveParameters) {\n        this.curveParameters = curveParameters;\n    }\n\n    sample(tStart: number, tEnd: number, samplingRate: number) : Sample {\n        const {amplitude, frequency} = this.curveParameters;\n        const phase = this.curveParameters.phase || 0;\n\n        const step = 1 / samplingRate;\n        const pairs: TimeValue[] = [];\n        for (let time = tStart; time <= tEnd; time += step) {\n            const pair: TimeValue = {time, value: amplitude * Math.sin((time * frequency + phase) * 2 * Math.PI)};\n            pairs.push(pair);\n        }\n\n        return pairs;\n\n    }\n}\n\nexport default SineCurve;","import React, {Component} from 'react';\n\nimport './TimePlot.scss';\nimport {Sample} from 'model/types';\nimport { calculateDefaultTicks } from '@wounded-pixels/eda';\n\ntype Props = {\n    values: Sample;\n    width: number;\n    height: number;\n    minY?: number;\n    maxY?: number;\n};\n\nconst padding = {\n    top: 5,\n    right: 0,\n    bottom: 40,\n    left: 25,\n};\n\nclass TimePlot extends Component<Props> {\n    calculateSvgX(domainX: number): number {\n        const {values, width} = this.props;\n        const tStart = values[0].time;\n        const tEnd = values[values.length - 1].time;\n        const domainWidth = tEnd - tStart;\n        const adjustedSvgWidth = width - padding.left - padding.right;\n        return padding.left + (domainX - tStart) * adjustedSvgWidth / domainWidth;\n    };\n\n    calculateSvgY(rangeY: number): number {\n        const {values, height} = this.props;\n        const minY = this.props.minY || Math.min(...values.map(v => v.value));\n        const maxY = this.props.maxY || Math.max(...values.map(v => v.value));\n        const rangeHeight = maxY - minY;\n        const adjustedSvgHeight = height - padding.top - padding.bottom;\n        const rawSvgY = (rangeY - minY) * adjustedSvgHeight / rangeHeight;\n        return padding.top + adjustedSvgHeight - rawSvgY;\n    };\n\n    render(): JSX.Element {\n        const {values, width, height} = this.props;\n        const tStart = values[0].time;\n        const tEnd = values[values.length - 1].time;\n        const minY = this.props.minY || Math.min(...values.map(v => v.value));\n        const maxY = this.props.maxY || Math.max(...values.map(v => v.value));\n\n        const xTickValues = calculateDefaultTicks(tStart, tEnd);\n        const yTickValues = calculateDefaultTicks(minY, maxY);\n\n        const viewBox = `0 0 ${width} ${height}`;\n\n        let curvePath = `M ${this.calculateSvgX(tStart)} ${this.calculateSvgY(values[0].value)} `;\n        for (let index=1; index < values.length; index++) {\n            curvePath += `L ${this.calculateSvgX(values[index].time)} ${this.calculateSvgY(values[index].value)} `;\n        }\n\n        const horizontalGridLines = yTickValues.map((yValue: number, index: number) => {\n            return (\n                <path\n                    key={index}\n                    className=\"grid-line\"\n                    d={`M ${this.calculateSvgX(tStart)} ${this.calculateSvgY(yValue)} L ${this.calculateSvgX(tEnd)} ${this.calculateSvgY(yValue)}`}\n                />\n            );\n        });\n\n        const verticalGridLines = xTickValues.map((xValue: number, index: number) => {\n          return (\n            <path\n                key={index}\n                className=\"grid-line\"\n                d={`M ${this.calculateSvgX(xValue)} ${this.calculateSvgY(minY)} L ${this.calculateSvgX(xValue)} ${this.calculateSvgY(maxY)}`}\n            />\n          );\n        });\n\n        const curve = (\n          <path\n            className=\"curve\"\n            d={curvePath}\n          />\n        );\n\n        const inMilliseconds = xTickValues[xTickValues.length-1] < 0.2;\n        const timeLabel = inMilliseconds ? 'time (milliseconds)' : 'time (seconds)';\n        const bottomLabel = (\n            <text\n                className=\"bottom-label\"\n                x={0.52 * width}\n                y={height - 0.2 * padding.bottom}\n            >\n                {timeLabel}\n            </text>\n        );\n\n        const xLabels = xTickValues.map((xValue, index) => {\n            const adjustedXValue = inMilliseconds ? xValue * 1000 : xValue;\n            return (\n                <text\n                    key={index}\n                    className=\"x-axis-label\"\n                    x={this.calculateSvgX(xValue)}\n                    y={height - 0.6 * padding.bottom}\n                >\n                    {adjustedXValue}\n                </text>\n            )\n        });\n\n        const yLabels = yTickValues.map((yValue, index) => {\n            return index % 2 === 0 ? (\n                <text\n                    key={index}\n                    className=\"y-axis-label\"\n                    x={padding.left * 0.75}\n                    y={this.calculateSvgY(yValue)}\n                    >\n                    {yValue}\n                </text>\n            ) : null;\n        });\n\n        return (\n          <div className=\"TimePlot\" style={{width: `${width}px`, height: `${height}px`}}>\n             <svg\n                 style={{width: `${width}px`, height: `${height}px`}}\n                 viewBox={viewBox}\n             >\n                 {verticalGridLines }\n                 {horizontalGridLines}\n                 {xLabels}\n                 {yLabels}\n                 {bottomLabel}\n                 {curve}\n             </svg>\n          </div>\n        );\n    };\n}\n\nexport default TimePlot;\n","import {Sample, TimeValue} from 'model/types';\n\nexport const addSamples = (...samples: Sample[]) : Sample => {\n    const sum: TimeValue[] = [];\n\n    for (let col_index=0; col_index < samples[0].length; col_index++) {\n        sum.push({time: samples[0][col_index].time, value: 0});\n        for (let sample_index=0; sample_index < samples.length; sample_index++) {\n            sum[col_index].value += samples[sample_index][col_index].value;\n        }\n    }\n\n    return sum;\n};","import {cloneDeep} from 'lodash';\n\nimport React, { Component } from 'react';\n\nimport CurveControl from 'components/CurveControl';\nimport SineCurve from 'model/SineCurve';\nimport TimePlot from 'components/TimePlot';\nimport { addSamples } from 'util/samples';\n\nimport {CurveParameters, Sample} from 'model/types';\nimport {\n    Context,\n    Hint,\n    KeyIdea,\n    Row,\n    ScenarioLink,\n    ScrollToTopOnMount,\n    Symbol,\n    Topic,\n    Visualization\n} from 'components/stateless-helpers';\nimport { Link } from 'react-router-dom';\n\ntype Props = {};\n\ntype State = {\n    curveParameters: CurveParameters[];\n};\n\nconst jaggedParameters: CurveParameters[] = [\n    { amplitude: 3.1, frequency: 2.7},\n    { amplitude: 1.3, frequency: 9.1},\n];\n\nconst flatParameters: CurveParameters[] = [\n    { amplitude: 3, frequency: 1},\n    { amplitude: 0.5, frequency: 3}\n];\n\nconst beatParameters: CurveParameters[] = [\n    { amplitude: 2, frequency: 7},\n    { amplitude: 2, frequency: 8},\n];\n\nconst examples: { [index: string] : CurveParameters[] }  = { jaggedParameters, beatParameters, flatParameters };\n\nclass SimpleAddition extends Component<Props, State> {\n    state = {\n        curveParameters: [\n            {amplitude: 1, frequency: 1},\n            {amplitude: 1, frequency: 2},\n        ] as CurveParameters[]\n    };\n\n    onChangeCurveParameter = (curveNumber: number, parameterName: 'amplitude' | 'frequency' | 'phase', value: number) => {\n        const state = this.state;\n        state.curveParameters[curveNumber][parameterName] = value;\n        this.setState(state);\n    };\n\n    onExample = (rawKey: string) => {\n        const key = rawKey + 'Parameters';\n        if (examples[key]) {\n            this.setState({curveParameters: cloneDeep(examples[key])});\n        } else {\n            this.setState({curveParameters: cloneDeep(jaggedParameters)});\n        }\n    };\n\n    render(): JSX.Element {\n        const samplingRate = 1200;\n        const tEnd = 5;\n\n        const {curveParameters} = this.state;\n        const firstSample: Sample = new SineCurve(curveParameters[0])\n            .sample(0, tEnd, samplingRate);\n\n        const secondSample: Sample = new SineCurve(curveParameters[1])\n            .sample(0, tEnd, samplingRate);\n\n        const combined: Sample = addSamples(firstSample, secondSample);\n\n        const amplitude = 5;\n        const timePlotHeight = 150;\n\n        return (\n            <Topic>\n                <ScrollToTopOnMount />\n                <h2>Addition of Sine Curves</h2>\n                <Context>\n                    Adding sine curves is pretty simple, but it can produce some very strange results:\n                    The inputs below allow you to control the amplitude and frequency of two sine curves.\n                    Their sum is shown at the bottom.\n                    <ul>\n                    <li>\n                        A combination of two smooth curves can be\n                        <ScenarioLink index=\"jagged\" onClick={this.onExample}>\n                          surprisingly jagged\n                        </ScenarioLink>\n                    </li>\n                    <li>\n                        A mixture of curves with similar frequencies produces a\n                        <ScenarioLink index=\"beat\" onClick={this.onExample}>\n                          wave of waves\n                        </ScenarioLink>\n                        or beat\n                    </li>\n                    <li>\n                        It is even easy to get a curve with a\n                        <ScenarioLink index=\"flat\" onClick={this.onExample}>\n                          flattened top and bottom\n                        </ScenarioLink>\n                    </li>\n                    </ul>\n                    What strange patterns can you create?\n                </Context>\n                <Visualization>\n                  <Row>\n                      <CurveControl onChange={this.onChangeCurveParameter} curveNumber={0} curveParameters={this.state.curveParameters[0]}/>\n                      <TimePlot width={500} height={timePlotHeight} minY={-amplitude} maxY={amplitude} values={firstSample}/>\n                  </Row>\n                  <Row>\n                      <Symbol width=\"150px\">+</Symbol>\n                      <Symbol width=\"100%\">&nbsp;</Symbol>\n                  </Row>\n                  <Row>\n                      <CurveControl onChange={this.onChangeCurveParameter} curveNumber={1} curveParameters={this.state.curveParameters[1]}/>\n                      <TimePlot width={500} height={timePlotHeight} minY={-amplitude} maxY={amplitude} values={secondSample}/>\n                  </Row>\n                  <Row>\n                      <Symbol width=\"150px\">=</Symbol>\n                      <TimePlot width={500} height={2 * timePlotHeight} minY={-2*amplitude} maxY={2*amplitude} values={combined} />\n                  </Row>\n                </Visualization>\n                <Context>\n                  <h3>Things to Try</h3>\n                  <Hint text=\"Focus on the difference between the two frequencies\">\n                    Can you see a pattern with beats? Specifically, can you make the\n                    <ScenarioLink index=\"beat\" onClick={this.onExample}> beat </ScenarioLink> slower\n                  </Hint>\n                  <Hint text=\"Focus on the ratio of the frequencies and the ratio of the amplitudes\">\n                    What other combinations cause\n                    <ScenarioLink index=\"flat\" onClick={this.onExample}>\n                      flat tops and bottoms\n                    </ScenarioLink>\n                  </Hint>\n                  <h3>Why Bother?</h3>\n                  <div>\n                      Our world may be more digital every day, but the real world is analog - radio waves travel from here\n                      to Mars or from your phone to your Bluetooth headphones. Sound waves travel from your speakers to your ears.\n                  </div>\n                  <KeyIdea>\n                      When data travels through air, wires, fiber optic cables or the vacuum of space\n                      it is usually encoded with fancy combinations of sine waves!\n                  </KeyIdea>\n                  <div>\n                     Engineering and medical data is often easier to understand if it is modeled as the sum of sine waves.\n                     Electrical activity from the heart and brain can be measured and modeled to help researchers and practitioners.\n                     While the scale of the waves are very different, the same mathematical techniques that help scientists\n                     understand the behavior of the heart also apply to vibrations in the earth's crust!\n                  </div>\n                </Context>\n                <Context>\n                  <div>\n                      Many academic and professional pursuits build on these concepts:\n                      <ul>\n                          <li>Acoustics</li>\n                          <li>Electronic music</li>\n                          <li>Electrical Engineering</li>\n                          <li>Radios and Software Defined Radios</li>\n                          <li>Radar systems</li>\n                          <li>Understanding complex periodic data from cardiology to seismology</li>\n                      </ul>\n                  </div>\n                </Context>\n                <Context>\n                    <h3>Next Steps</h3>\n                    <div>\n                        If adding two sine curves produce interesting results then we clearly have to try\n                        more. Many many more. So, we need a way to quickly control the amplitudes of\n                        <Link to=\"/sum-many-sines\"> many sines</Link>.\n                    </div>\n                </Context>\n            </Topic>\n        );\n    };\n}\nexport default SimpleAddition;\n","import React, { FunctionComponent } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport './TopNav.scss';\nimport {LabeledPath} from 'model/types';\n\nconst buildLink = (labeledPath: LabeledPath) => {\n    return (<Link key={labeledPath.path} to={labeledPath.path}>{labeledPath.label}</Link>);\n};\n\ntype Props = {\n    home: LabeledPath,\n    links: LabeledPath[],\n    centerText: string,\n};\n\nconst TopNav: FunctionComponent<Props> = ({home, links, centerText}) => {\n    const linkElements = links.map(buildLink);\n    return (\n        <div className=\"TopNav\">\n            <div className=\"left-nav-link\">\n                { buildLink(home)}\n            </div>\n            <div className=\"center-text\">\n                {centerText}\n            </div>\n            <div className=\"right-nav-link\">\n                {linkElements}\n            </div>\n        </div>\n    );\n};\n\nexport default TopNav;","import {CurveParameters} from \"../model/types\";\n\nexport function round(raw: number, multiplier = 100) {\n    return Math.round(raw * multiplier) / multiplier;\n}\n\nexport function clamp(value: number, min: number, max: number) {\n    if (value > max) {\n        return max;\n    }\n\n    if (value < min) {\n        return min;\n    }\n\n    return value;\n}\n\nexport function snap(value: number, digits: number) {\n    const multiplier = 10 ** digits;\n    return Math.round(value*multiplier) / multiplier;\n}\n\nexport function convolve(signal: number[], kernel: number[]) {\n    const output: number[] = [];\n    const maxOutputIndex = signal.length + kernel.length - 1;\n    for (let outIndex = 0; outIndex < maxOutputIndex; outIndex++) {\n        output.push(0);\n        for (let kernelIndex = 0; kernelIndex < kernel.length; kernelIndex++) {\n            const signalIndex = outIndex - kernelIndex;\n            if (signalIndex < 0 || signalIndex >= signal.length) {\n                continue;\n            }\n\n            output[outIndex] += signal[signalIndex] * kernel[kernelIndex];\n        }\n    }\n\n    return output;\n}\n\nexport function createSignal(length: number, curveParameters: CurveParameters[], repetitions: number = 2) {\n    const values: number[] = [];\n\n    const lowestFrequency = Math.min(...curveParameters.map(cp => cp.frequency));\n    const interval = repetitions * 2 * Math.PI / lowestFrequency; // we want the overall signal to repeat repetitions times\n    const dt = interval / length;\n\n    for (let time = 0; time < interval; time = time + dt) {\n        let value = 0;\n        for (const curveParameter of curveParameters) {\n            value = value + curveParameter.amplitude * Math.sin(curveParameter.frequency * time);\n        }\n\n        values.push(value);\n    }\n\n    return values;\n}\n\nexport function createNoise(length: number, mean: number, std: number) {\n    const values = [];\n    const sampleCount = 7;\n\n    for (let index = 0; index < length; index++) {\n        let sum = 0;\n        for (let sampleIndex = 0; sampleIndex < sampleCount; sampleIndex++) {\n            sum += Math.random();\n        }\n\n        // center at zero\n        sum = sum - sampleCount/2;\n\n        // apply std\n        sum = sum * std;\n\n        // recenter on mean\n        sum += mean;\n\n        values.push(sum);\n    }\n\n    return values;\n}\n\nexport function addSignals(first: number[], second: number[]) {\n    const values = [];\n\n    const maxIndex = Math.min(first.length, second.length);\n    for (let index = 0; index < maxIndex; index++) {\n        values.push(first[index] + second[index]);\n    }\n\n    return values;\n}\n\nexport function multiplySignals(first: number[], second: number[]) {\n    const values = [];\n\n    const maxIndex = Math.min(first.length, second.length);\n    for (let index = 0; index < maxIndex; index++) {\n        values.push(first[index] * second[index]);\n    }\n\n    return values;\n}\n\nexport function sinc(time: number) {\n    if (time === 0) {\n        return 1;\n    }\n\n    return Math.sin(Math.PI * time) / (Math.PI * time);\n}\n\nexport function createLowPassKernel(cutoffFrequency: number, length: number = 51) {\n    const values = [];\n    for (let step = -Math.round(length / 2); step <= length / 2; step++) {\n        values.push(sinc(2 * cutoffFrequency * step));\n    }\n\n    return values;\n}\n\nexport function spectralInvert(kernel: number[]) {\n    const values = kernel.map(value => -value);\n    const middleIndex = Math.round(values.length/2);\n    values[middleIndex] += 1;\n    return values;\n}\n\nexport function addZeroes(kernel: number[]) {\n    const values = [...kernel];\n    for (let index = 0; index < kernel.length; index++) {\n        values.push(0);\n    }\n\n    return values;\n}\n\nexport function normalize(raw: number[]) {\n    const sum = raw.reduce((sum, value) => { return value +  sum;}, 0);\n    return raw.map(value => value / sum);\n}\n\nexport function createBlackmanWindow(length: number = 51) {\n    const values = [];\n\n    for (let step = 0; step < length; step++) {\n        values.push(0.42 - 0.5 * Math.cos(2 * Math.PI * step / length) + 0.08 * Math.cos(4 * Math.PI * step / length));\n    }\n\n    return values;\n}\n\n","import React, {Component, Fragment} from 'react';\n\nimport './StepsPlot.scss';\n\nimport { calculateDefaultTicks } from '@wounded-pixels/eda';\nimport {convolve} from 'util/math-hacks';\n\ntype Props = {\n    width: number;\n    height: number;\n    plotAmplitude: number;\n    signalAmplitudes: number[];\n    kernelAmplitudes: number[];\n    iIndex: number;\n    jIndex: number;\n};\n\nconst padding = {\n    top: 5,\n    right: 40,\n    bottom: 0,\n    left: 100,\n};\n\nconst circleSize = 3;\n\nclass StepsPlot extends Component<Props> {\n    calculateSvgX(timeIndex: number): number {\n        const {signalAmplitudes, kernelAmplitudes, width} = this.props;\n        const domainWidth = signalAmplitudes.length + 2*kernelAmplitudes.length + 1;\n        const adjustedSvgWidth = width - padding.left - padding.right;\n        return padding.left + (timeIndex + kernelAmplitudes.length) * adjustedSvgWidth / domainWidth;\n    };\n\n    calculateSvgY(value: number, section: number): number {\n        const {height, plotAmplitude} = this.props;\n        const rangeHeight = plotAmplitude * 2;\n        const adjustedSvgHeight = (height - padding.top - padding.bottom) / 3;\n        const rawSvgY = (value + plotAmplitude) * adjustedSvgHeight / rangeHeight;\n        return padding.top + section * adjustedSvgHeight + adjustedSvgHeight - rawSvgY;\n    };\n\n    calculateSvgSignalY(value: number): number {\n        return this.calculateSvgY(value, 0);\n    };\n\n    calculateSvgKernelY(value: number): number {\n        return this.calculateSvgY(value, 1);\n    };\n\n    calculateSvgOutputSignalY(value: number): number {\n        return this.calculateSvgY(value, 2);\n    };\n\n    render(): JSX.Element {\n        const {width, height, iIndex, jIndex, plotAmplitude, kernelAmplitudes, signalAmplitudes} = this.props;\n\n        const outputSignalAmplitudes = convolve(signalAmplitudes, kernelAmplitudes);\n\n        const viewBox = `0 0 ${width} ${height}`;\n\n        const yTickValues = calculateDefaultTicks(-plotAmplitude, plotAmplitude);\n\n        const labelOffset = 0;\n        const axisLabelOffset = -8;\n\n        const signalLabel = (\n            <text className=\"section-label\" x={labelOffset} y={this.calculateSvgSignalY(0)}>\n               Signal\n            </text>\n        );\n\n        const kernelLabel = (\n            <text className=\"section-label\" x={labelOffset} y={this.calculateSvgKernelY(0)}>\n                Kernel\n            </text>\n        );\n\n        const outputSignalLabel = (\n            <text className=\"section-label\" x={labelOffset} y={this.calculateSvgOutputSignalY(0)}>\n                Output Signal\n            </text>\n        );\n\n        const signalAxisLabels = yTickValues.map((yValue: number, index: number) => {\n            return (\n                <text\n                    key={index}\n                    className=\"axis-label\"\n                    x={this.calculateSvgX(0) + axisLabelOffset}\n                    y={this.calculateSvgSignalY(yValue)}>\n                    {yValue}\n                </text>\n            );\n        });\n\n        const kernelAxisLabels = yTickValues.map((yValue: number, index: number) => {\n            return (\n                <text\n                    key={index}\n                    className=\"axis-label\"\n                    x={this.calculateSvgX(iIndex-kernelAmplitudes.length+1) + axisLabelOffset}\n                    y={this.calculateSvgKernelY(yValue)}>\n                    {yValue}\n                </text>\n            );\n        });\n        const outputSignalAxisLabels = yTickValues.map((yValue: number, index: number) => {\n            return (\n                <text\n                    key={index}\n                    className=\"axis-label\"\n                    x={this.calculateSvgX(0) + axisLabelOffset}\n                    y={this.calculateSvgOutputSignalY(yValue)}>\n                {yValue}\n                </text>\n            );\n        });\n\n        const horizontalSignalGridLines = yTickValues.map((yValue: number, index: number) => {\n            return (\n                <path\n                    key={index}\n                    className=\"grid-line\"\n                    d={`M ${this.calculateSvgX(0)} ${this.calculateSvgSignalY(yValue)}\n                        L ${this.calculateSvgX(signalAmplitudes.length-1)} ${this.calculateSvgSignalY(yValue)}`\n                      } />\n            );\n        });\n\n        const horizontalKernelGridLines = yTickValues.map((yValue: number, index: number) => {\n            return (\n                <path\n                    key={index}\n                    className=\"grid-line\"\n                    d={`M ${this.calculateSvgX(iIndex-kernelAmplitudes.length+1)} ${this.calculateSvgKernelY(yValue)}\n                        L ${this.calculateSvgX(iIndex)} ${this.calculateSvgKernelY(yValue)}`\n                    } />\n            );\n        });\n\n        const horizontalOutputSignalGridLines= yTickValues.map((yValue: number, index: number) => {\n            return (\n                <path\n                    key={index}\n                    className=\"grid-line\"\n                    d={`M ${this.calculateSvgX(0)} ${this.calculateSvgOutputSignalY(yValue)}\n                        L ${this.calculateSvgX(signalAmplitudes.length+kernelAmplitudes.length-1)} ${this.calculateSvgOutputSignalY(yValue)}`\n                    } />\n            );\n        });\n\n        const diagonalLines = kernelAmplitudes.map((value, index) => {\n            const signalIndex = iIndex - index;\n            const className = jIndex === index ? 'current-diagonal' : 'diagonal';\n            return index <= jIndex && signalIndex >= 0 && signalIndex < signalAmplitudes.length ? (\n                <path\n                    key={index}\n                    className={className}\n                    d={`M ${this.calculateSvgX(signalIndex)} ${this.calculateSvgSignalY(signalAmplitudes[signalIndex])}\n                        L ${this.calculateSvgX(iIndex - kernelAmplitudes.length + 1 + index)} ${this.calculateSvgKernelY(value)}`\n                    } />\n            ) : null;\n        }).filter(line => line !== null);\n\n        const showDecorations = jIndex >= 0 && diagonalLines.length > 0;\n        const signalCircles = signalAmplitudes.map((value, index) => {\n            let className = 'unused-signal-value';\n            if (showDecorations && index === (iIndex - jIndex)) {\n                className = 'current-signal-value' ;\n            } else if (index > (iIndex - kernelAmplitudes.length) && index <= iIndex) {\n                className = 'signal-value';\n            }\n            return (<circle\n                key={index}\n                className={className}\n                cx={this.calculateSvgX(index)}\n                cy={this.calculateSvgSignalY(value)}\n                r={circleSize}\n            />);\n        });\n\n        const kernelCircles = kernelAmplitudes.map((value, index) => {\n            const className = index === jIndex ? 'current-kernel-value' : 'kernel-value';\n            return (<circle\n                key={index}\n                className={className}\n                cx={this.calculateSvgX(iIndex - kernelAmplitudes.length +1 + index)}\n                cy={this.calculateSvgKernelY(value)}\n                r={circleSize}\n            />);\n        });\n\n        const outputSignalCircles = outputSignalAmplitudes.map((value, index) => {\n            const className = (index < iIndex) ? 'previous-out-signal-value' : 'future-out-signal-value';\n\n            return index <= iIndex ? (<circle\n                key={index}\n                className={className}\n                cx={this.calculateSvgX(index)}\n                cy={this.calculateSvgOutputSignalY(value)}\n                r={circleSize}\n            />) : null;\n        });\n\n        const productSum = kernelAmplitudes.reduce((total, value, index) => {\n            const signalIndex = iIndex - index;\n            return index <= jIndex && signalIndex >= 0 && signalIndex < signalAmplitudes.length ?\n                total + value * signalAmplitudes[signalIndex] :\n                total;\n        }, 0);\n\n        const currentOutputSignalCircle = showDecorations ? (\n            <circle\n                className=\"current-out-signal-value\"\n                cx={this.calculateSvgX(iIndex)}\n                cy={this.calculateSvgOutputSignalY(productSum)}\n                r={circleSize}\n            />\n        ) : null;\n\n\n        const crossRadius = 4;\n        const crossBackgroundRadius = crossRadius + 5;\n\n        const crossCenterX = (this.calculateSvgX(iIndex - jIndex) + this.calculateSvgX(iIndex - kernelAmplitudes.length + 1 + jIndex)) / 2;\n        const crossCenterY = (this.calculateSvgSignalY(signalAmplitudes[iIndex - jIndex]) + this.calculateSvgKernelY(kernelAmplitudes[jIndex])) / 2;\n        const multiplicationSign = showDecorations && iIndex - jIndex >= 0 && iIndex - jIndex < signalAmplitudes.length ? (\n            <Fragment>\n                <rect className=\"multiplication-sign-background\"\n                      x={crossCenterX - crossBackgroundRadius}\n                      y={crossCenterY - crossBackgroundRadius}\n                      width={2*crossBackgroundRadius}\n                      height={2*crossBackgroundRadius}/>\n                <line className=\"multiplication-sign\"\n                      x1={crossCenterX - crossRadius}\n                      y1={crossCenterY - crossRadius}\n                      x2={crossCenterX + crossRadius}\n                      y2={crossCenterY + crossRadius}/>\n                <line className=\"multiplication-sign\"\n                      x1={crossCenterX - crossRadius}\n                      y1={crossCenterY + crossRadius}\n                      x2={crossCenterX + crossRadius}\n                      y2={crossCenterY - crossRadius}/>\n            </Fragment>\n        ) : null;\n\n        const linesToPlus = kernelAmplitudes.map((value, index) => {\n            const signalIndex = iIndex - index;\n            const className = jIndex === index ? 'current-diagonal' : 'diagonal';\n            return index <= jIndex && signalIndex >= 0 && signalIndex < signalAmplitudes.length ? (\n                <path\n                    key={index}\n                    className={className}\n                    d={`M ${this.calculateSvgX(iIndex - kernelAmplitudes.length + 1 + index)} ${this.calculateSvgKernelY(value)}\n                        L ${this.calculateSvgX(iIndex)} ${this.calculateSvgKernelY(-10)}`\n                    } />\n            ) : null;\n        });\n\n        const plusRadius = 5;\n        const plusBackgroundRadius = plusRadius + 4;\n        const plusCenterX = this.calculateSvgX(iIndex);\n        const plusCenterY = this.calculateSvgKernelY(-10);\n        const plusSign = showDecorations ? (\n            <Fragment>\n                <rect className=\"plus-sign-background\"\n                      x={plusCenterX - plusBackgroundRadius}\n                      y={plusCenterY - plusBackgroundRadius}\n                      width={2*plusBackgroundRadius}\n                      height={2*plusBackgroundRadius}/>\n                <line className=\"plus-sign\"\n                      x1={plusCenterX - plusRadius}\n                      y1={plusCenterY}\n                      x2={plusCenterX + plusRadius}\n                      y2={plusCenterY}/>\n                <line className=\"plus-sign\"\n                      x1={plusCenterX}\n                      y1={plusCenterY - plusRadius}\n                      x2={plusCenterX}\n                      y2={plusCenterY + plusRadius}/>\n            </Fragment>\n        ) : null;\n\n        const lineToProductSum = showDecorations ? (\n            <line className=\"current-diagonal\"\n                  x1={plusCenterX}\n                  y1={plusCenterY}\n                  x2={plusCenterX}\n                  y2={this.calculateSvgOutputSignalY(productSum)} />\n        ) : null;\n\n        return (\n            <div className=\"StepsPlot\" style={{width: `${width}px`, height: `${height}px`}}>\n                <svg\n                    style={{width: `${width}px`, height: `${height}px`}}\n                    viewBox={viewBox}\n                >\n                    {signalLabel}\n                    {kernelLabel}\n                    {outputSignalLabel}\n                    {signalAxisLabels}\n                    {kernelAxisLabels}\n                    {outputSignalAxisLabels}\n                    {horizontalSignalGridLines}\n                    {horizontalKernelGridLines}\n                    {horizontalOutputSignalGridLines}\n                    {diagonalLines}\n                    {linesToPlus}\n                    {lineToProductSum}\n                    {multiplicationSign}\n                    {plusSign}\n                    {signalCircles}\n                    {kernelCircles}\n                    {currentOutputSignalCircle}\n                    {outputSignalCircles}\n                </svg>\n            </div>\n        );\n    }\n}\n\nexport default StepsPlot;\n","import React, { Component } from 'react';\n\nimport './ConvolutionSteps.scss';\n\nimport {\n    Context,\n    Row,\n    ScenarioLink,\n    ScrollToTopOnMount,\n    Topic,\n    Visualization,\n} from 'components/stateless-helpers';\nimport StepsPlot from './StepsPlot';\nimport {\n    addSignals,\n    addZeroes, createBlackmanWindow,\n    createLowPassKernel,\n    createNoise,\n    createSignal,\n    multiplySignals,\n    normalize,\n    round,\n    spectralInvert\n} from 'util/math-hacks';\n\ntype Props = {};\n\ntype State = {\n    signalAmplitudes: number[];\n    kernelAmplitudes: number[];\n    iIndex: number;\n    jIndex: number;\n    playing: boolean;\n};\n\nconst PLOT_AMPLITUDE = 10;\nconst TICK_INTERVAL = 25;\n\nconst shortSignal = [-2, -1, 0, 1, 2, 3, 3, 3, 3, 2, 1, 0, -1, -2, -3, -3, -3];\nconst longLength = 1000;\nconst longSignal = createSignal(longLength, [{frequency: 1, amplitude: 5}, {frequency: 10, amplitude: 1}], 4);\nconst lowWithNoiseSignal = addSignals(createSignal(longLength, [{frequency:1, amplitude: 3}], 4), createNoise(longLength, 0, 1.0));\nconst lowBackgroundSignal = createSignal(longLength, [{frequency: 1, amplitude: 1}, {frequency: 10, amplitude: 3}], 4);\n\nconst sampleKernel = [-1, 1, 1];\nconst flipKernel = [-1];\nconst derivativeKernel = [1, -1];\nconst delayKernel = [0, 0, 0, 1];\n\nconst longKernelLength = 100;\nconst rawLowPassKernel = normalize(multiplySignals(createLowPassKernel(0.02, longKernelLength), createBlackmanWindow(longKernelLength)));\nconst lowpassKernel = addZeroes(rawLowPassKernel);\nconst highpassKernel = addZeroes(spectralInvert(rawLowPassKernel));\n\nconst exampleKernels: { [index: string] : number[]} = {\n    sampleKernel,\n    flipKernel,\n    derivativeKernel,\n    delayKernel,\n    lowpassKernel,\n    highpassKernel,\n};\n\nconst exampleSignals: { [index: string] : number[]} = {\n    shortSignal,\n    longSignal,\n    lowWithNoiseSignal,\n    lowBackgroundSignal,\n};\n\nclass ConvolutionSteps extends Component<Props, State> {\n    state = {\n        signalAmplitudes: shortSignal,\n        kernelAmplitudes: sampleKernel,\n        iIndex: 5,\n        jIndex: -1,\n        playing: false,\n    };\n\n    onSelectKernel = (rawKey: string) => { const key = rawKey + 'Kernel';\n        if (exampleKernels[key]) {\n            const signalAmplitudes =  (exampleKernels[key].length > 0.25 * this.state.signalAmplitudes.length) ?\n              longSignal :\n              this.state.signalAmplitudes;\n\n            const iIndex = signalAmplitudes.length + exampleKernels[key].length - 2;\n            this.setState({iIndex: iIndex, jIndex: exampleKernels[key].length - 1, signalAmplitudes, kernelAmplitudes: exampleKernels[key]});\n        } else {\n            const iIndex = shortSignal.length + sampleKernel.length - 2;\n            const jIndex = sampleKernel.length - 1;\n            this.setState({iIndex, jIndex, signalAmplitudes: shortSignal, kernelAmplitudes: sampleKernel});\n        }\n    };\n\n    onSelectSignal = (rawKey: string) => { const key = rawKey + 'Signal';\n        if (exampleSignals[key]) {\n            const kernelAmplitudes = this.state.kernelAmplitudes.length > 0.25 * exampleSignals[key].length ?\n                sampleKernel :\n                this.state.kernelAmplitudes;\n            const iIndex = exampleSignals[key].length + kernelAmplitudes.length - 2;\n            const jIndex = kernelAmplitudes.length - 1;\n            this.setState({iIndex: iIndex, jIndex, signalAmplitudes: exampleSignals[key], kernelAmplitudes});\n        } else {\n            const iIndex = shortSignal.length + sampleKernel.length - 2;\n            const jIndex = sampleKernel.length - 1;\n            this.setState({iIndex, jIndex, signalAmplitudes: shortSignal, kernelAmplitudes: sampleKernel});\n        }\n    }\n\n    incrementIndex = () => {\n        const {iIndex, jIndex, kernelAmplitudes, signalAmplitudes} = this.state;\n        if (iIndex === signalAmplitudes.length + kernelAmplitudes.length - 2 && jIndex === kernelAmplitudes.length - 1) {\n            this.setState({playing: false, iIndex: 0, jIndex: -1});\n        } else if (jIndex === kernelAmplitudes.length - 1) {\n            this.setState({playing: false, iIndex: iIndex + 1, jIndex: -1});\n        } else {\n            this.setState({playing: false, jIndex: jIndex + 1 })\n        }\n    };\n\n    doPlay = () => {\n        const {iIndex, kernelAmplitudes, signalAmplitudes} = this.state;\n        if (this.state.playing) {\n            if (iIndex === signalAmplitudes.length + kernelAmplitudes.length - 2) {\n                this.setState({iIndex: 0, jIndex: kernelAmplitudes.length - 1});\n            } else {\n                this.setState({iIndex: iIndex + 1, jIndex: kernelAmplitudes.length - 1 })\n            }\n\n            setTimeout(this.doPlay, TICK_INTERVAL);\n        }\n    };\n\n    togglePlay = () => {\n        this.setState({playing: !this.state.playing});\n        setTimeout(this.doPlay, TICK_INTERVAL);\n    };\n\n    incrementToEnd = () => {\n        const {kernelAmplitudes, signalAmplitudes} = this.state;\n        this.setState({playing: false, iIndex: signalAmplitudes.length+kernelAmplitudes.length-2, jIndex: kernelAmplitudes.length-1});\n    };\n\n    buildCommentary(): string {\n        const {iIndex, jIndex, kernelAmplitudes, playing, signalAmplitudes} = this.state;\n        const signalIndex = iIndex - jIndex;\n\n        if (playing || kernelAmplitudes.length > 10) {\n            return '';\n        }\n        if (jIndex === -1) {\n            return `The grey dots in the output signal represent the values that have already been calculated. The empty\n            dot represents the value that is about to be calculated. Each dark black value in the signal will be\n            multiplied with one of the kernel values to contribute to the output value.`;\n        }\n\n        if (signalIndex >= signalAmplitudes.length) {\n            return `Things get a little odd as the kernel slides past the edge of the input signal. If there is no\n            corresponding input value for a kernel value then it is assumed to be zero.`\n        }\n\n        if (signalIndex < 0) {\n            return `Things get a little odd as the kernel slides up to the edge of the input signal. If there is no\n            corresponding input value for a kernel value then it is assumed to be zero.`\n        }\n\n        const signalValue = signalAmplitudes[signalIndex];\n        const kernelValue = kernelAmplitudes[jIndex];\n        if (jIndex === 0) {\n            return `Each value in the kernel is associated with the opposite value in the input signal in a \n           criss cross pattern. In this step the blue ${round(signalValue)} from the input signal is multiplied by the\n           green ${round(kernelValue)} from the kernel to contribute ${round(signalValue * kernelValue)} to the output signal.`\n        }\n\n        if (jIndex === 1) {\n            return `The running total is shown in orange in the output signal.`;\n        }\n\n        return `Once you get past the odd criss cross pattern it is just repetitive multiplication and addition. But if\n        a computer does it fast enough you can get some amazing results.`;\n    }\n\n    render(): JSX.Element {\n        const {signalAmplitudes, playing, kernelAmplitudes, iIndex, jIndex} = this.state;\n\n        const commentary = this.buildCommentary();\n\n        const productSpans = kernelAmplitudes.map((value, index) => {\n            const signalIndex = iIndex - index;\n            const signalText = ''+round(signalAmplitudes[signalIndex]);\n            const kernelText = ''+round(value);\n            const symbol = index < jIndex ? ' + ' : ' = ';\n            const signalSpanClass = index === jIndex ? 'current-signal-span' : 'signal-span';\n            const kernelSpanClass = index === jIndex ? 'current-kernel-span' : 'kernel-span';\n\n            if (index > jIndex) {\n                return null;\n            }\n\n            if (signalIndex >= 0 && signalIndex < signalAmplitudes.length) {\n                return (\n                <span key={index}>\n                    <span>(</span>\n                    <span className={signalSpanClass}>{signalText}</span>\n                    <span>x</span>\n                    <span className={kernelSpanClass}>{kernelText}</span>\n                    <span>)</span>\n                    <span>{symbol}</span>\n                </span>); }\n\n            return (\n                <span key={index}>\n                    <span className={signalSpanClass}>0</span><span>{symbol}</span>\n                </span>);\n        });\n\n        const rawProductSum = kernelAmplitudes.reduce((total, value, index) => {\n            const signalIndex = iIndex - index;\n            return index <= jIndex && signalIndex >= 0 && signalIndex < signalAmplitudes.length ?\n                total + value * signalAmplitudes[signalIndex] :\n                total;\n        }, 0);\n\n        const productSum = round(rawProductSum);\n        const resultSummary = jIndex >= 0 && !playing && kernelAmplitudes.length < 10 ?\n            (<div> {productSpans}<span className=\"product-sum\">{productSum}</span></div>) :\n            null;\n\n        return (\n            <Topic className=\"ConvolutionSteps\">\n                <ScrollToTopOnMount />\n                <h2>Convolution Steps</h2>\n                <Context>\n                    Convolution is a powerful way to alter or filter a signal by combining it with another signal.\n                    In our case both signals are represented by discrete points rather than smooth or continuous curves.\n                    <p/>\n                    The signal that we are trying to modify is combined with a carefully selected smaller signal called\n                    a kernel. Each element of the output signal is calculated by applying the kernel values to a block\n                    of points in the signal that is the same size as the kernel. The kernel slides along the input signal\n                    until all the values of the output signal have been calculated.\n\n                    Use the 'Next' button below to see the sequence of steps that calculate each point in the output signal.\n                </Context>\n                <Visualization>\n                    <StepsPlot width={800}\n                               height={500}\n                               plotAmplitude={PLOT_AMPLITUDE}\n                               signalAmplitudes={signalAmplitudes}\n                               kernelAmplitudes={kernelAmplitudes}\n                               iIndex={iIndex}\n                               jIndex={jIndex} />\n                </Visualization>\n                <Row>\n                    <button onClick={this.incrementIndex}>Next</button>\n                    <button onClick={this.togglePlay}>{this.state.playing ? 'Stop' : 'Play'}</button>\n                    <button onClick={this.incrementToEnd}>End</button>\n                    &nbsp;\n                    {resultSummary}\n                </Row>\n                <Row>\n                    <div className=\"commentary\">\n                        {commentary}\n                    </div>\n                </Row>\n                <Context>\n                    <h3>More Signals</h3>\n                    The initial<ScenarioLink index=\"short\" onClick={this.onSelectSignal}>sample signal</ScenarioLink>\n                    is devised to make the math easy to follow. More interesting signals include\n                    <ScenarioLink index=\"long\" onClick={this.onSelectSignal}>high and low frequencies</ScenarioLink>,\n                    <ScenarioLink index=\"lowBackground\" onClick={this.onSelectSignal}>low frequency in the background</ScenarioLink> and\n                    <ScenarioLink index=\"lowWithNoise\" onClick={this.onSelectSignal}>low frequency with noise.</ScenarioLink>\n                </Context>\n                <Context>\n                    <h3>More Kernels</h3>\n                   The initial<ScenarioLink index=\"sample\" onClick={this.onSelectKernel}>sample kernel</ScenarioLink>\n                    is devised to make the math easy to follow. More interesting kernels include\n                    <ScenarioLink index=\"flip\" onClick={this.onSelectKernel}>flipping</ScenarioLink>\n                    the signal, <ScenarioLink index=\"delay\" onClick={this.onSelectKernel}>delaying</ScenarioLink> the signal,\n                    <ScenarioLink index=\"derivative\" onClick={this.onSelectKernel}>taking the derivative</ScenarioLink>\n                    of the signal and <ScenarioLink index=\"lowpass\" onClick={this.onSelectKernel}>filtering for low frequencies.</ScenarioLink>\n                    Filters that allow low frequencies to pass through to the output signal and suppress higher frequencies are known as low pass filters.\n                    <ScenarioLink index=\"highpass\" onClick={this.onSelectKernel}>High pass filters</ScenarioLink> do the opposite\n                    task as they allow high frequency signals to pass through to the output signal.\n                </Context>\n            </Topic>\n        );\n    };\n}\n\nexport default ConvolutionSteps;\n","import React, { FunctionComponent } from 'react';\nimport {Context, Topic} from 'components/stateless-helpers';\nimport { Link } from 'react-router-dom';\n\ntype Props = {};\nconst Topics: FunctionComponent<Props> = () => {\n    return (\n        <Topic>\n            <h2>Topics</h2>\n            <h3><Link to=\"/unit-circle\">Sine, Cosine and the Unit Circle</Link></h3>\n            <Context>\n                DSP depends on sine waves and you need to understand the unit circle in order to understand sine waves.\n                This visualization shows how the height and width of the triangle in the unit circle map to the sine and cosine curves.\n            </Context>\n            <h3><Link to=\"/sine-over-time\">Sine over Time</Link></h3>\n            <Context>\n                In trigonometry sine is all about angles of triangles. In DSP it is all about\n                sound or signal intensity over time.\n            </Context>\n            <h3><Link to=\"/add-sines\">Addition of Sine Curves</Link></h3>\n            <Context>\n                Simple combinations of the humble sine curve yield many strange and useful curves.\n                Let's start by specifying the amplitude and frequency of two curves and adding them together.\n            </Context>\n            <h3><Link to=\"/sum-many-sines\">Sum of Many Sines</Link></h3>\n            <Context>\n                We can get interesting shapes by adding two sines together. What mischief can we create with twenty?\n            </Context>\n            <h3><Link to=\"/sounds-from-sines\">Sounds from Sines</Link></h3>\n            <Context>\n                We can make some fairly interesting sounds by combining sine waves\n            </Context>\n            <h3><Link to=\"/convolution=steps\">Convolution Steps</Link></h3>\n            <Context>\n                Convolution is not as complicated as it first appears. Ok, why it works is still magic to me but we can\n                definitely understand the mechanics!\n            </Context>\n            <h3>Coming Soon</h3>\n            <ul>\n                <li>Encoding information with Amplitude Modulation</li>\n                <li>Encoding information with Frequency Modulation</li>\n                <li>Introduction to Convolution</li>\n                <li>Convolution - DSP's Swiss army chainsaw</li>\n                <li>Discrete Fast Fourier Transforms</li>\n                <li>Sampling</li>\n            </ul>\n        </Topic>\n    );\n};\n\nexport default Topics;\n","import React, {Component} from 'react';\n\nimport './FrequencyDomainControl.scss';\nimport {clamp, snap} from '../util/math-hacks';\n\ntype Props = {\n    amplitudes: number[];\n    frequencies: number[];\n    maxAmplitude: number;\n    onChange: (frequencyIndex: number, value: number) => void;\n};\n\ntype State = {\n    activeDragIndex: number;\n};\n\nconst width = 800;\nconst height = 300;\n\nconst padding = {\n    top: 15,\n    right: 0,\n    bottom: 50,\n    left: 30,\n};\n\nconst knobAllocation = (width - padding.left - padding.right) / 20;\nconst knobDimensions = {\n    width: knobAllocation * 0.6,\n    height: 10,\n    margin: knobAllocation * 0.2,\n};\n\nconst calculateKnobX = (index: number) => {\n    return padding.left + index * (knobDimensions.width + 2 * knobDimensions.margin);\n};\n\n\nclass FrequencyDomainControl extends Component<Props, State> {\n    private svgRef: any = React.createRef();\n\n    state = {\n        activeDragIndex: -1,\n    };\n\n    calculateKnobY = (amplitudeValue: number) => {\n        const scale = (height - padding.top - padding.bottom) / (2 * this.props.maxAmplitude);\n        const minAmplitude = -this.props.maxAmplitude;\n        const rawY = (amplitudeValue - minAmplitude) * scale;\n        return height - padding.bottom - rawY;\n    };\n\n    calculateAmplitudeFromY = (yValue: number) => {\n        const scale =  (2 * this.props.maxAmplitude) / (height - padding.top - padding.bottom);\n        const adjustedY = yValue - padding.top;\n        return this.props.maxAmplitude - adjustedY * scale;\n    }\n\n    calculateTooltipX = (frequencyIndex: number) => {\n      const baseX = calculateKnobX(frequencyIndex);\n      const offset = frequencyIndex < 10 ? knobDimensions.width + 32 : -70;\n      return baseX + offset;\n    };\n\n    convertToPlotY = (eventY: number) => {\n        const CTM = this.svgRef.current.getScreenCTM();\n        return (eventY - CTM.f) / CTM.d;\n    };\n\n    onChange = (index: number, newY: number, evt: any) => {\n        if (this.state.activeDragIndex === index) {\n            evt.preventDefault();\n            const {maxAmplitude} = this.props;\n            const newAmplitude = snap(this.calculateAmplitudeFromY(newY), 1);\n            this.props.onChange(index, clamp(newAmplitude, -maxAmplitude, maxAmplitude));\n        }\n    };\n\n    startDrag = (index: number, evt: any) => {\n        evt.preventDefault();\n        this.setState({activeDragIndex: index});\n    };\n\n    stopDrag = (evt: any) => {\n        evt.preventDefault();\n        this.setState({activeDragIndex: -1});\n    }\n\n    render(): JSX.Element {\n        const {amplitudes, maxAmplitude} = this.props;\n        const minFrequency = this.props.frequencies[0];\n        const maxFrequency = this.props.frequencies[19];\n\n\n        const bottomLabel = (\n          <text\n            className=\"bottom-label\"\n            x={0.4 * width}\n            y={height - 0.35 * padding.bottom}\n            >\n              frequencies from {minFrequency} to {maxFrequency} Hz\n          </text>\n        );\n\n        const amplitudeLabels = [-maxAmplitude, 0, maxAmplitude].map((value: number, index: number) => {\n           return (\n             <text\n                 key={index}\n                 className=\"amplitude-label\"\n                 x={8}\n                 y={this.calculateKnobY(value) + 8}\n             >\n                 {value}\n             </text>\n           );\n        });\n\n        const knobs = amplitudes.map((amplitude: number, index: number) => {\n            const onMove = (evt: React.MouseEvent) => {\n                const convertedY = this.convertToPlotY(evt.clientY);\n                this.onChange(index, convertedY, evt);\n            };\n\n            const onTouch = (evt: React.TouchEvent) => {\n                const convertedY = this.convertToPlotY(evt.touches[0].clientY);\n                this.onChange(index, convertedY, evt);\n            };\n\n            return (\n                <g key={index}>\n                    <rect\n                        className=\"channel-background\"\n                        x={calculateKnobX(index)}\n                        y={this.calculateKnobY(maxAmplitude)}\n                        width={knobDimensions.width}\n                        height={this.calculateKnobY(-maxAmplitude) - this.calculateKnobY(maxAmplitude)}\n                        onMouseMove={onMove}\n                        onMouseDown={(evt) => this.startDrag(index, evt)}\n                        onMouseUp = {(evt) => this.stopDrag(evt)}\n                        onTouchStart = {(evt) => this.startDrag(index, evt)}\n                        onTouchEnd = {(evt) => this.stopDrag(evt)}\n                        onTouchMove={onTouch}\n                    />\n                    <rect\n                        className=\"channel\"\n                        x={calculateKnobX(index) + knobDimensions.width*0.4}\n                        y={this.calculateKnobY(maxAmplitude)}\n                        width={0.2 * knobDimensions.width}\n                        height={this.calculateKnobY(-maxAmplitude) - this.calculateKnobY(maxAmplitude)}\n                        onMouseMove={onMove}\n                        onMouseDown={(evt) => this.startDrag(index, evt)}\n                        onMouseUp = {(evt) => this.stopDrag(evt)}\n                        onTouchStart = {(evt) => this.startDrag(index, evt)}\n                        onTouchEnd = {(evt) => this.stopDrag(evt)}\n                        onTouchMove={onTouch}\n                    />\n                    <rect\n                        className=\"knob\"\n                        x={calculateKnobX(index)}\n                        y={this.calculateKnobY(amplitude) - knobDimensions.height /2 }\n                        width={knobDimensions.width}\n                        height={knobDimensions.height}\n                        onMouseMove={onMove}\n                        onMouseDown={(evt) => this.startDrag(index, evt)}\n                        onMouseUp = {(evt) => this.stopDrag(evt)}\n                        onTouchStart = {(evt) => this.startDrag(index, evt)}\n                        onTouchEnd = {(evt) => this.stopDrag(evt)}\n                        onTouchMove={onTouch}\n                    />\n                </g>\n            );\n        });\n\n        const viewBox = `0 0 ${width} ${height}`;\n        const {activeDragIndex} = this.state;\n\n        const activeChangeDescription = activeDragIndex >= 0 ? (\n            <g>\n                <rect\n                    className=\"active-change-description\"\n                    x={this.calculateTooltipX(activeDragIndex)}\n                    y={this.calculateKnobY(this.props.amplitudes[activeDragIndex])}\n                    width={60}\n                    height={50}\n                    />\n                <text\n                    x={this.calculateTooltipX(activeDragIndex) + 10}\n                    y={this.calculateKnobY(this.props.amplitudes[activeDragIndex]) + 20}\n                    className=\"active-change-description\">\n                    {this.props.frequencies[activeDragIndex]} Hz\n                </text>\n                <text\n                    x={this.calculateTooltipX(activeDragIndex) + 10}\n                    y={this.calculateKnobY(this.props.amplitudes[activeDragIndex]) + 40}\n                    className=\"active-change-description\">\n                    {this.props.amplitudes[activeDragIndex]}\n                </text>\n            </g>\n        ) : null;\n\n        return (\n            <div className=\"FrequencyDomainControl\">\n                <svg\n                    ref={this.svgRef}\n                    viewBox={viewBox}>\n                    {bottomLabel}\n                    {amplitudeLabels}\n                    {knobs}\n                    {activeChangeDescription}\n                </svg>\n            </div>\n        );\n    };\n}\n\nexport default FrequencyDomainControl;\n","import {cloneDeep} from 'lodash';\n\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport SineCurve from 'model/SineCurve';\n\nimport FrequencyDomainControl from 'components/FrequencyDomainControl';\nimport TimePlot from 'components/TimePlot';\n\nimport { addSamples } from 'util/samples';\n\nimport {Sample, TimeValue} from 'model/types';\nimport {\n    Context,\n    Hint,\n    KeyIdea, Row,\n    ScenarioLink,\n    ScrollToTopOnMount,\n    Topic,\n    Visualization, ZoomControl\n} from 'components/stateless-helpers';\nimport {clamp} from 'util/math-hacks';\n\ntype Props = {};\n\ntype State = {\n    amplitudes: number[];\n    zoomLevel: number,\n};\n\nconst MAX_ZOOM_INDEX = 3;\n\nconst frequencies = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];\n\nconst clearFrequencies = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst justOneFrequencies = [0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst spikyFrequencies =  [0, 0, 1, 0, 0, 1, 0, 0, 1.5, 0, 0, 2, 0, 0, 1, 0, 0, 3, 0, 0];\nconst oldBeatFrequencies = [0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst flatBeatFrequencies = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, -4, 0 ,0, 0, 0];\nconst alternatingBeatFrequencies = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 2, -1, 0 ,0, 0];\nconst twoFourSixFrequencies = [0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst inkFrequencies = [1.3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2 ,-0.4, 0.2];\n\nconst examples: { [index: string] : number[]} = {\n    alternatingBeatFrequencies,\n    clearFrequencies,\n    flatBeatFrequencies,\n    justOneFrequencies,\n    spikyFrequencies,\n    twoFourSixFrequencies,\n    inkFrequencies,\n    oldBeatFrequencies\n};\n\nclass SumOfManySines extends Component<Props, State> {\n    state = {\n        amplitudes: cloneDeep(justOneFrequencies),\n        zoomLevel: 1,\n        logMessage: '',\n    };\n\n    onZoom = (increment: number) => {\n        const newZoom = clamp(this.state.zoomLevel + increment, 0, MAX_ZOOM_INDEX);\n        this.setState({zoomLevel: newZoom});\n    }\n\n    onExample = (rawKey: string) => {\n        const key = rawKey + 'Frequencies';\n        if (examples[key]) {\n            this.setState({amplitudes: cloneDeep(examples[key])});\n        } else {\n            this.setState({amplitudes: cloneDeep(oldBeatFrequencies)});\n        }\n    }\n\n    onChange = (frequencyIndex: number, value: number) => {\n      const amplitudes = [...this.state.amplitudes];\n      amplitudes[frequencyIndex] = value;\n      this.setState({amplitudes});\n    };\n\n    render(): JSX.Element {\n        const plotAmplitude = 10;\n        const controlAmplitude = 4;\n        const samplingRate = 2000;\n\n        const tEnd = 0.5 * (2 ** this.state.zoomLevel);\n\n        const curves: SineCurve[] = this.state.amplitudes.map((amplitude, index) => {\n           return new SineCurve({amplitude, frequency: index + 1});\n        });\n\n        const samples: TimeValue[][] = curves.map((curve: SineCurve) => curve.sample(0, tEnd, samplingRate));\n        const combined: Sample = addSamples(...samples)\n        return (\n            <Topic>\n                <ScrollToTopOnMount />\n                <h2>Sum of Many Sines</h2>\n                <Context>\n                    Each slider allows you to change the amplitude of a sine at that frequency.\n                    <ul>\n                        <li>\n                            The simplest example\n                            <ScenarioLink index=\"justOne\" onClick={this.onExample}>\n                                is a single non-zero amplitude\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            A mixture of frequencies at regular intervals produces a\n                            <ScenarioLink index=\"spiky\" onClick={this.onExample}>\n                                very spiky curve\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            A mixture of curves with similar frequencies produces a\n                            <ScenarioLink index=\"beat\" onClick={this.onExample}>\n                                wave of waves\n                            </ScenarioLink>\n                            or beat. You may recall this combination from the previous page\n                        </li>\n                        <li>\n                            If you use three curves and are willing to go negative for one you can get a\n                            beat with a\n                            <ScenarioLink index=\"flatBeat\" onClick={this.onExample}>\n                                flattened top and bottom\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            With a gap between the primary frequencies you can get alternating\n                            <ScenarioLink index=\"alternatingBeat\" onClick={this.onExample}>\n                                long and short beats\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            A low frequency mixed with a few high frequencies can create a line and\n                            <ScenarioLink index=\"ink\" onClick={this.onExample}>\n                                brush stroke effect\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            You may want to\n                            <ScenarioLink index=\"clear\" onClick={this.onExample}>\n                            clear all frequencies\n                            </ScenarioLink>\n                        </li>\n                    </ul>\n                </Context>\n                <Visualization>\n                    <div>\n                        <TimePlot values={combined} width={800} height={400} minY={-plotAmplitude} maxY={plotAmplitude}/>\n                        <Row>\n                            <button onClick={() => this.onExample('clear') }>Clear</button>\n                            <ZoomControl current={this.state.zoomLevel} min={0} max={MAX_ZOOM_INDEX} onZoom={this.onZoom} />\n                        </Row>\n                    </div>\n                    <div>\n                        <FrequencyDomainControl\n                          amplitudes={this.state.amplitudes}\n                          frequencies={frequencies}\n                          maxAmplitude={controlAmplitude}\n                          onChange={this.onChange}\n                        />\n                    </div>\n                </Visualization>\n                <Context>\n                    <h3>Things to Try</h3>\n                    A harmonic series is made up of sine curves whose frequencies are integer multiples of a fundamental frequency.\n                    Such as\n                        <ScenarioLink index=\"twoFourSix\" onClick={this.onExample}>two, four and six</ScenarioLink> in\n                        which the first frequency, two Hz, is the fundamental frequency.\n                        <Hint text=\"Focus on the fundamental frequency\">\n                        Can you make a harmonic series that repeats 4 times a second? Or 5?\n                    </Hint>\n                    <h3>Why Bother?</h3>\n                    <div>\n                        As we discussed in the previous page on the <Link to=\"/add-sines\">addition of sine curves</Link>,\n                        creating complicated curves from simple sines allows us to communicate in the real world.\n                    </div>\n                    <KeyIdea>\n                        Any periodic function can be represented by the sum of sine curves, provided you use enough of them.\n                        Fourier analysis is the branch of mathematics that is dedicated to the tricky bit of calculating\n                        the right amplitudes\n                    </KeyIdea>\n                </Context>\n                <Context>\n                    <h3>Next Steps</h3>\n                    Sine waves are not just interesting to look at.\n                    Adding sines together <Link to=\"/sounds-from-sines\">can make sounds</Link> as well.\n                </Context>\n            </Topic>\n        );\n    };\n}\n\nexport default SumOfManySines;\n","import React, {Component} from 'react';\n\nimport './UnitCircleControl.scss';\nimport {snap} from 'util/math-hacks';\n\ntype Props = {\n    onChange: (piRatio: number) => void;\n    piRatio: number;\n    revealLevel: number;\n};\n\ntype State = {\n  activeDrag: boolean;\n};\n\nconst sideLength = 150;\nconst padding = 25;\n\nconst domainMinimum = -1;\nconst rangeMinimum = -1;\nconst domainHeight = 2;\nconst domainWidth = 2;\nconst adjustedSvgHeight = sideLength - 2 * padding;\nconst adjustedSvgWidth = sideLength - 2 * padding;\n\nclass UnitCircleControl extends Component<Props, State> {\n    private svgRef: any = React.createRef();\n\n    state = {\n        activeDrag: false,\n    };\n\n    calculateSvgX(domainX: number): number {\n        return padding + (domainX - domainMinimum) * adjustedSvgWidth / domainWidth;\n    };\n\n    calculateDomainX(eventX: number): number {\n        const CTM = this.svgRef.current.getScreenCTM();\n        const svgX = (eventX - CTM.e) / CTM.a;\n        const adjustedSvgX = svgX - padding;\n        return domainMinimum + adjustedSvgX * domainWidth / adjustedSvgWidth;\n    };\n\n    calculateSvgY(rangeY: number): number {\n        const rawSvgY = (rangeY - rangeMinimum) * adjustedSvgHeight / domainHeight;\n        return padding + adjustedSvgHeight - rawSvgY;\n    };\n\n    calculateDomainY(eventY: number): number {\n        const CTM = this.svgRef.current.getScreenCTM();\n        const svgY = (eventY - CTM.f) / CTM.d;\n        const svgUp = adjustedSvgHeight - svgY;\n        return rangeMinimum + svgUp * domainHeight / adjustedSvgHeight;\n    };\n\n    onChange = (newSvgX: number, newSvgY: number, evt: any) => {\n        if (this.state.activeDrag) {\n            evt.preventDefault();\n\n            const newDomainX = this.calculateDomainX(newSvgX);\n            const newDomainY = this.calculateDomainY(newSvgY);\n\n            const newAngle = Math.atan2(newDomainY, newDomainX);\n            const piRatio = snap(newAngle / Math.PI, 2);\n            this.props.onChange(piRatio);\n        }\n    };\n\n    onMove = (evt: React.MouseEvent) => {\n        this.onChange(evt.clientX, evt.clientY, evt);\n    };\n\n    onTouch = (evt: React.TouchEvent) => {\n        this.onChange(evt.touches[0].clientX, evt.touches[0].clientY, evt);\n    };\n\n    startDrag = (evt: any) => {\n        evt.preventDefault();\n        this.setState({activeDrag: true});\n    };\n\n    stopDrag = (evt: any) => {\n        evt.preventDefault();\n        this.setState({activeDrag: false});\n    }\n\n    render(): JSX.Element {\n        const { piRatio, revealLevel } = this.props;\n\n        const viewBox = `0 0 ${sideLength} ${sideLength}`;\n\n        const svgRadius = (sideLength - 2 * padding) / 2;\n\n        const centerX = this.calculateSvgX(0);\n        const centerY = this.calculateSvgY(0);\n\n        const largeArc = piRatio <= 1 ? 0 : 1;\n        const positiveSweep = 0;\n        const xArcRadius = this.calculateSvgX(1) - this.calculateSvgX(0);\n        const yArcRadius = this.calculateSvgY(1) - this.calculateSvgY(0);\n\n        const horizontalLineEnd = this.calculateSvgX(Math.cos(piRatio * Math.PI));\n        const verticalLineEnd = this.calculateSvgY(Math.sin(piRatio * Math.PI));\n\n        const offsetRadius = 1.08;\n        const angleLabelDomainX = offsetRadius * Math.cos(piRatio * Math.PI / 2);\n        const angleLabelRangeY  = offsetRadius * Math.sin(piRatio * Math.PI / 2);\n        const textAnchor = angleLabelDomainX > 0 ? 'start' : 'end';\n\n        const plotTitle = (\n            <text\n                className=\"plot-title\"\n                x={this.calculateSvgX(0)}\n                y=\"11\"\n            >\n                Unit Circle\n            </text>\n        );\n\n        const angleLabel = (\n            <text\n                className=\"angle-label\"\n                x={this.calculateSvgX(angleLabelDomainX)}\n                y={this.calculateSvgY(angleLabelRangeY)}\n                textAnchor={textAnchor}\n            >\n                {piRatio}&#960;\n            </text>\n        );\n\n        const backgroundCircle = (\n            <circle\n                className=\"background-circle\"\n                cx={centerX}\n                cy={centerY}\n                r={svgRadius}\n            />\n        );\n\n        const horizontalLine = (\n            <path\n              className=\"horizontal-line\"\n              d={`M ${centerX} ${centerY} L ${horizontalLineEnd} ${centerY}`}\n          />\n        );\n\n        const verticalLine = (\n            <path\n                className=\"vertical-line\"\n                d={`M ${horizontalLineEnd} ${centerY} L ${horizontalLineEnd} ${verticalLineEnd}`}\n            />\n        );\n\n        const radiusLine = (\n            <path\n                className=\"radius-line\"\n                d={`M ${centerX} ${centerY} L ${horizontalLineEnd} ${verticalLineEnd}`}\n            />\n        );\n\n        const verticalLineRangeY = Math.sin(piRatio * Math.PI);\n        const horizontalDomainX = Math.cos(piRatio * Math.PI);\n        const verticalLineLabel =\n            Math.abs(verticalLineRangeY) > 0.1 ? (\n                <text\n                    className=\"vertical-line-label\"\n                    textAnchor={horizontalDomainX > 0 ? 'end' : 'start'}\n                    x={horizontalLineEnd + (horizontalDomainX > 0 ? -5 : 5) }\n                    y={(centerY + verticalLineEnd) /2}\n                >\n                    {verticalLineRangeY.toFixed(2)}\n                </text>\n            ) : null;\n\n        const horizontalLineLabel =\n            Math.abs(horizontalDomainX) > 0.1 ? (\n                <text\n                    className=\"horizontal-line-label\"\n                    x={(horizontalLineEnd + centerX) / 2 }\n                    y={centerY + (verticalLineRangeY > 0 ? 8 : -6) }\n                >\n                    {horizontalDomainX.toFixed(2)}\n                </text>\n            ) : null;\n\n        const foregroundArc = (\n            <path\n                className=\"arc\"\n                d={`M ${this.calculateSvgX(1)} ${this.calculateSvgY(0)} A ${xArcRadius},${yArcRadius} 0 ${largeArc} ${positiveSweep} ${horizontalLineEnd} ${verticalLineEnd}`}\n                />\n        );\n\n        const activeChangeDescription = null;\n\n        const knob = (\n            <circle\n                className=\"knob\"\n                cx={horizontalLineEnd}\n                cy={verticalLineEnd}\n                r={2}\n                onMouseMove={this.onMove}\n                onMouseDown={this.startDrag}\n                onMouseUp = {this.stopDrag}\n                onTouchStart = {this.startDrag}\n                onTouchEnd = {this.stopDrag}\n                onTouchMove={this.onTouch}\n            />\n        );\n\n        const triangle = revealLevel >= 1 ?\n            (\n                <React.Fragment>\n                {horizontalLine}\n                {verticalLine}\n                {verticalLineLabel}\n                {horizontalLineLabel}\n                </React.Fragment>\n            ) : null;\n\n        return (\n            <div className=\"UnitCircleControl\">\n                <svg\n                    ref={this.svgRef}\n                    viewBox={viewBox}\n                    onMouseMove={this.onMove}\n                    onMouseDown={this.startDrag}\n                    onMouseUp = {this.stopDrag}\n                    onTouchStart = {this.startDrag}\n                    onTouchEnd = {this.stopDrag}\n                    onTouchMove={this.onTouch}\n                >\n                    {plotTitle}\n                    {backgroundCircle}\n                    {radiusLine}\n                    {triangle}\n                    {foregroundArc}\n                    {angleLabel}\n                    {knob}\n                    {activeChangeDescription}\n                </svg>\n            </div>\n        );\n    };\n}\n\nexport default UnitCircleControl","import React, {Component} from 'react';\n\nimport './AnnotatedCurveControl.scss';\nimport {clamp, snap} from 'util/math-hacks';\n\ntype Props = {\n    yFunction: (angleValue: number) => number;\n    onChange: (piRatio: number) => void;\n    piRatio: number;\n};\n\ntype State = {\n    activeDrag: boolean;\n};\n\nconst svgHeight = 300;\nconst svgWidth = 750;\nconst padding = {\n    top: 40,\n    right: 0,\n    bottom: 40,\n    left: 20,\n};\n\nconst domainMinimum = 0;\nconst domainMaximum = 2 * Math.PI;\nconst domainWidth = domainMaximum - domainMinimum;\nconst rangeMinimum = -1;\nconst rangeMaximum = 1;\nconst rangeHeight = rangeMaximum - rangeMinimum;\nconst adjustedSvgHeight = svgHeight - padding.top - padding.bottom;\nconst adjustedSvgWidth = svgWidth - padding.left - padding.right;\n\nclass AnnotatedCurveControl extends Component<Props, State> {\n    private svgRef: any = React.createRef();\n\n    state = {\n        activeDrag: false,\n    };\n\n    calculateSvgX(domainX: number): number {\n        return padding.left + (domainX - domainMinimum) * adjustedSvgWidth / domainWidth;\n    };\n\n    calculateDomainX(eventX: number): number {\n        const CTM = this.svgRef.current.getScreenCTM();\n        const svgX = (eventX - CTM.e) / CTM.a;\n        const adjustedSvgX = svgX - padding.left;\n        return domainMinimum + adjustedSvgX * domainWidth / adjustedSvgWidth;\n    };\n\n    calculateSvgY(rangeY: number): number {\n        const rawSvgY = (rangeY - rangeMinimum) * adjustedSvgHeight / rangeHeight;\n        return padding.top + adjustedSvgHeight - rawSvgY;\n    };\n\n    calculateRangeY(eventY: number): number {\n        const CTM = this.svgRef.current.getScreenCTM();\n        const svgY = (eventY - CTM.f) / CTM.d;\n        const svgUp = adjustedSvgHeight - svgY;\n        return rangeMinimum + svgUp * rangeHeight / adjustedSvgHeight;\n    };\n\n    onChange = (newSvgX: number, newSvgY: number, evt: any) => {\n        if (this.state.activeDrag) {\n            evt.preventDefault();\n\n            const newAngle = clamp(this.calculateDomainX(newSvgX), 0, 2 * Math.PI);\n            const piRatio = snap(newAngle / Math.PI, 2);\n            this.props.onChange(piRatio);\n        }\n    };\n\n    onMove = (evt: React.MouseEvent) => {\n        this.onChange(evt.clientX, evt.clientY, evt);\n    };\n\n    onTouch = (evt: React.TouchEvent) => {\n        this.onChange(evt.touches[0].clientX, evt.touches[0].clientY, evt);\n    };\n\n    startDrag = (evt: any) => {\n        evt.preventDefault();\n        this.setState({activeDrag: true});\n    };\n\n    stopDrag = (evt: any) => {\n        evt.preventDefault();\n        this.setState({activeDrag: false});\n    }\n\n    render(): JSX.Element {\n        const { yFunction, piRatio } = this.props;\n        const title = yFunction === Math.sin ? 'Sine' : 'Cosine';\n\n        const viewBox = `0 0 ${svgWidth} ${svgHeight}`;\n\n        const horizontalLineBegin = this.calculateSvgX(0);\n        const horizontalLineEnd = this.calculateSvgX(piRatio * Math.PI);\n        const verticalLineStart = this.calculateSvgY(0);\n        const verticalLineEnd = this.calculateSvgY(yFunction(piRatio * Math.PI));\n\n        const verticalStrokeColor = yFunction === Math.sin ? 'orange' : 'blue';\n\n        const step = 0.1;\n        let curvePath = `M ${this.calculateSvgX(0)} ${this.calculateSvgY(yFunction(0))} `;\n        for (let angle = step; angle <= 2 * Math.PI + step; angle += step) {\n           curvePath += `L ${this.calculateSvgX(angle)} ${this.calculateSvgY(yFunction(angle))} `;\n        }\n\n        const curve = (\n          <path\n          className=\"curve\"\n          d={curvePath}\n          />\n        );\n\n        const plotTitle = (\n            <text\n                className=\"plot-title\"\n                x={this.calculateSvgX(Math.PI)}\n                y=\"13\"\n            >\n                {title}\n            </text>\n        );\n\n        const angleLabelDomainX = clamp(piRatio * Math.PI / 2, 0.1, Math.PI);\n        const angleLabelVerticalOffset = yFunction(angleLabelDomainX) < 0 ? -15 : 25;\n        const angleLabel = (\n            <text\n                className=\"angle-label\"\n                x={this.calculateSvgX(angleLabelDomainX)}\n                y={this.calculateSvgY(0) + angleLabelVerticalOffset}\n                >\n                {piRatio}&#960;\n            </text>\n        );\n\n        const horizontalLine = (\n            <path\n                className=\"horizontal-line\"\n                d={`M ${horizontalLineBegin} ${verticalLineStart} L ${horizontalLineEnd} ${verticalLineStart}`}\n            />\n        );\n\n        const verticalLine = (\n            <path\n                className=\"vertical-line\"\n                stroke={verticalStrokeColor}\n                d={`M ${horizontalLineEnd} ${verticalLineStart} L ${horizontalLineEnd} ${verticalLineEnd}`}\n            />\n        );\n\n        const verticalLineValue = yFunction(piRatio * Math.PI);\n        const verticalLineLabel =\n            Math.abs(verticalLineValue) > 0.1 ? (\n                <text\n                className=\"vertical-line-label\"\n                fill={verticalStrokeColor}\n                textAnchor={piRatio < 1.7 ? 'start' : 'end'}\n                x={horizontalLineEnd + (piRatio < 1.7 ? 8 : -8) }\n                y={(verticalLineStart + verticalLineEnd) /2}\n            >\n                {verticalLineValue.toFixed(2)}\n            </text>\n            ) : null;\n        const activeChangeDescription = null;\n\n        const knob = (\n            <circle\n                className=\"knob\"\n                cx={horizontalLineEnd}\n                cy={verticalLineEnd}\n                r={4}\n                onMouseMove={this.onMove}\n                onMouseDown={this.startDrag}\n                onMouseUp = {this.stopDrag}\n                onTouchStart = {this.startDrag}\n                onTouchEnd = {this.stopDrag}\n                onTouchMove={this.onTouch}\n            />\n        );\n\n        return (\n            <div className=\"AnnotatedCurveControl\">\n                <svg\n                    ref={this.svgRef}\n                    viewBox={viewBox}\n                    onMouseMove={this.onMove}\n                    onMouseDown={this.startDrag}\n                    onMouseUp = {this.stopDrag}\n                    onTouchStart = {this.startDrag}\n                    onTouchEnd = {this.stopDrag}\n                    onTouchMove={this.onTouch}\n                >\n                    {plotTitle}\n                    {horizontalLine}\n                    {verticalLine}\n                    {curve}\n                    {angleLabel}\n                    {verticalLineLabel}\n                    {knob}\n                    {activeChangeDescription}\n                </svg>\n            </div>\n        );\n    };\n}\n\nexport default AnnotatedCurveControl;","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport {Context, RevealLink, Row, ScrollToTopOnMount, Topic, Visualization} from 'components/stateless-helpers';\nimport UnitCircleControl from './UnitCircleControl';\nimport AnnotatedCurveControl from './AnnotatedCurveControl';\n\ntype Props = {};\n\ntype State = {};\n\nconst clampPiRatio = (raw: number): number =>  {\n    const clamped = raw < 0 ? raw + 2 : raw;\n    return Math.round(clamped * 100)/100;\n};\n\nclass UnitCircleAndCurves extends Component<Props, State> {\n    state = {\n        piRatio: 0.25,\n        revealLevel: 0,\n    };\n\n    onChangePiRatio = (piRatio: number) => {\n        this.setState({piRatio: clampPiRatio(piRatio)});\n    };\n\n    setReveal = (revealLevel: number) => {\n        this.setState({revealLevel});\n    };\n\n    render(): JSX.Element {\n        const {revealLevel} = this.state;\n\n        return (\n            <Topic>\n                <ScrollToTopOnMount />\n                <h2>Sine, Cosine, and the Unit Circle</h2>\n                <Context>\n                    This visualization shows the anatomy of a\n                    <RevealLink onClick={() => this.setReveal(0)}>unit circle</RevealLink>\n                    and how a\n                    <RevealLink onClick={() => this.setReveal(1)}>traditional trig triangle</RevealLink>\n                    fits inside the unit circle.<p/>\n                    Then it shows how a unit circle is related to a\n                    <RevealLink onClick={() => {\n                        this.setReveal(2);\n                        this.onChangePiRatio(0.25);\n                    }}>sine curve.</RevealLink>\n                    Finally it brings\n                    <RevealLink onClick={() => {\n                        this.setReveal(3);\n                        this.onChangePiRatio(0.25);\n                    }}>cosine curves</RevealLink>\n                    into the picture.<p/>\n                    But let's start at the beginning.\n                </Context>\n                <Row>\n                    <Visualization>\n                        <UnitCircleControl onChange={this.onChangePiRatio} piRatio={this.state.piRatio} revealLevel={revealLevel}/>\n                    </Visualization>\n                    <Context>\n                        <Context>\n                            <h3>Unit Circle</h3>\n                            A unit circle is a circle that is centered at x=0, y=0.<p/>\n                            The white line from (0,0) to the circle always has length of 1.\n                            The green arc length shows the distance around the perimeter of the circle from (1,0).<p/>\n                            Perhaps you recall the formula for the perimeter\n                            of a circle?<br/>\n                            As you drag the grey knob around, what do you expect the arc length to be at the top?<br/>\n                            At the far left? At the bottom? Not that you will ever quite see it, but how about the far right?<p/>\n                            Now that our circle makes sense, let's add\n                            <RevealLink onClick={() => {\n                                this.setReveal(1);\n                                this.onChangePiRatio(0.25);\n                            }\n                            }>\n                            a triangle!\n                            </RevealLink>\n                        </Context>\n                    {revealLevel >= 1 && (\n                        <Context>\n                            <h3>The Triangle</h3>\n                            We just put a traditional right triangle from trigonometry inside of our circle with the\n                            hypotenuse along the radius with a length of 1.\n                            The horizontal or adjacent side is shown in blue and the vertical or opposite side is shown in orange.<p/>\n                            The length of the arc gives us a way to describe the inside angle of the triangle in radians.<p/>\n                            Focus on the length of the orange vertical line as you change the angle. It leads directly to our next topic,\n                            <RevealLink onClick={() => {\n                                this.setReveal(2);\n                                this.onChangePiRatio(0.25);\n                            }\n                            }>sine curves</RevealLink>\n                        </Context>\n                    )}\n                    </Context>\n                </Row>\n\n                {revealLevel >= 2 && (\n                    <Row>\n                        <Context>\n                            <h3>Sine Curve</h3>\n                            In our normal trig triangle, the sine of the angle is the length of\n                            the opposite side divided by the hypotenuse.\n                            Or to put it the other way, the height of the opposite side of a triangle is the hypotenuse\n                            multiplied by the sine of the angle.<p/>\n                            But our triangle is trapped in a unit circle! So, the hypotenuse is always 1 and the opposite side\n                            of the triangle and the sine of the angle are exactly the same.<p/>\n                            As you manipulate the angle you can see how the vertical side of the triangle in the unit circle\n                            matches up to the value of the sine curve (both in orange).<p/>\n                            The blue horizontal line in the triangle leads us to our last topic,\n                            <RevealLink onClick={() => {\n                                this.setReveal(3);\n                                this.onChangePiRatio(0.25);\n                            }\n                            }>cosine curves</RevealLink>\n                        </Context>\n                        <AnnotatedCurveControl onChange={this.onChangePiRatio} piRatio={this.state.piRatio} yFunction={Math.sin}/>\n                    </Row>\n                )}\n\n                {revealLevel >= 3 && (\n                   <Row>\n                       <Context>\n                           <h3>Cosine Curve</h3>\n                           The value of the blue cosine curve is the same as the length of the blue adjacent side of the triangle.\n                       </Context>\n                       <AnnotatedCurveControl onChange={this.onChangePiRatio} piRatio={this.state.piRatio} yFunction={Math.cos}/>\n                   </Row>\n                )}\n\n                <Context>\n                    <h3>Next Steps</h3>\n                    Now that we have built some understanding of what a sine curve means in the context of a triangle we can explore\n                    other uses. For example, many things change periodically <Link to=\"/sine-over-time\">over time</Link>.\n                </Context>\n            </Topic>\n        );\n    };\n}\nexport default UnitCircleAndCurves;","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport {\n    Context,\n    RevealLink,\n    Row,\n    ScrollToTopOnMount,\n    Symbol,\n    Title,\n    Topic,\n    Visualization\n} from 'components/stateless-helpers';\nimport CurveControl from \"../components/CurveControl\";\nimport TimePlot from \"../components/TimePlot\";\nimport {Sample} from \"../model/types\";\nimport SineCurve from \"../model/SineCurve\";\n\ntype Props = {};\n\ntype State = {\n    amplitude: number;\n    frequency: number;\n}\n\nclass SineOverTime extends Component<Props, State> {\n    state = {\n        amplitude: 2,\n        frequency: 1,\n        phase: 0,\n    };\n\n    onChangeCurveParameter = (curveNumber: number, parameterName: 'amplitude' | 'frequency' | 'phase', value: number) => {\n        const state = this.state;\n        state[parameterName] = value;\n        this.setState(state);\n    };\n\n    render(): JSX.Element {\n        const maxAmplitude = 5;\n        const timePlotHeight = 150;\n        const samplingRate = 600;\n        const tEnd = 5;\n\n        const {amplitude, frequency} = this.state;\n        const firstSample: Sample = new SineCurve({amplitude, frequency})\n            .sample(0, tEnd, samplingRate);\n\n        return (\n            <Topic>\n                <ScrollToTopOnMount />\n                <h2>Sine over Time</h2>\n                <Context>\n                    As the <Link to=\"/unit-circle\">previous topic</Link> showed, a sine curve tracks the height of the\n                    opposite side of a right triangle as the inner angle goes from zero to 2 in radians.<p/>\n                    Sine and cosine curves can also be used to model a lot of other physical phenomena.\n                    A single curve can be used to model:\n                    <ul>\n                        <li>alternating current in a wire</li>\n                        <li>the sound from a perfect tuning fork</li>\n                        <li>a constant frequency radio signal</li>\n                    </ul>\n                    In these applications the horizontal axis is no longer an angle but rather time. Instead of a length,\n                    the vertical axis represents some sort of intensity or strength.<p/>\n                    When discussing these curves, the most important characteristic is usually the frequency, as in how\n                    frequently does the curve repeat in a single second. A<RevealLink onClick={() => {\n                        this.setState({amplitude: 2});\n                        this.setState({frequency: 1});\n                    }}>1 Hertz</RevealLink>\n                    (1 Hz) sine curve repeats once every second.<p/>\n                    To get a curve that repeats f times a second, the argument to sine must be 2 multiplied by f.\n                </Context>\n                <Visualization>\n                    <Row>\n                        <Symbol width=\"150px\">&nbsp;</Symbol>\n                        <Title width=\"500px\">{amplitude} sin({frequency} x 2 x time) </Title>\n                    </Row>\n                    <Row>\n                        <CurveControl onChange={this.onChangeCurveParameter} curveNumber={0} curveParameters={{amplitude, frequency}}/>\n                        <TimePlot width={500} height={timePlotHeight} minY={-maxAmplitude} maxY={maxAmplitude} values={firstSample}/>\n                    </Row>\n                </Visualization>\n                <Context>\n                    <h3>Real life amplitudes and frequencies</h3>\n                    <ul>\n                        <li>Household current in the US is usually 120 Volts in amplitude with a frequency of 60 Hz</li>\n                        <li>A middle C tuning fork produces a roughly 50 decibel wave at 261.63 Hz</li>\n                        <li>A FM radio station produces waves with amplitudes that are generally below 50 thousand watts\n                            (50 kilowatts or 50kW) and frequencies that start at 88 million Hertz\n                            (88 megahertz or 88MHz).\n                        </li>\n                    </ul>\n                </Context>\n                <Context>\n                    <h3>Next Steps</h3>\n                    A single sine or cosine curve is pretty boring. As we will see in the next topic,\n                    adding <Link to=\"/add-sines\">two curves</Link> together can be surprisingly interesting.\n                </Context>\n            </Topic>\n        );\n    }\n}\n\nexport default SineOverTime;\n","import React, {Component} from 'react';\n\nimport './FrequencyDomainPlayer.scss';\n\ntype Props = {\n    amplitudes: number[];\n    frequencies: number[];\n    maxAmplitude: number;\n};\n\ntype State = {\n    first: boolean,\n    playing: boolean,\n};\n\nclass FrequencyDomainPlayer extends Component<Props, State> {\n    // @ts-ignore\n    private audioCtx: AudioContext = new (window.AudioContext || window.webkitAudioContext)();\n\n    private oscillators: OscillatorNode[] = [];\n    private amplitudeNodes: GainNode[] = [];\n    private mergeGainNode: GainNode = this.audioCtx.createGain();\n\n    state = {\n        first: true,\n        playing: false,\n    };\n\n    componentDidMount() {\n\n        for (let ctr = 0; ctr < this.props.amplitudes.length; ctr++) {\n            const oscillator = this.audioCtx.createOscillator();\n            oscillator.frequency.setValueAtTime(this.props.frequencies[ctr], this.audioCtx.currentTime);\n\n            const amplitudeNode = this.audioCtx.createGain();\n            amplitudeNode.gain.value = 0;\n\n            oscillator.connect(amplitudeNode);\n            amplitudeNode.connect(this.mergeGainNode);\n\n            this.oscillators.push(oscillator);\n            this.amplitudeNodes.push(amplitudeNode);\n        }\n        this.mergeGainNode.gain.value = 0.4;\n        this.mergeGainNode.connect(this.audioCtx.destination);\n    }\n\n    togglePlayer = () => {\n        const playing = !this.state.playing;\n\n        if (playing && this.state.first) {\n            for (const oscillator of this.oscillators) {\n                oscillator.start();\n            }\n            this.setState({first: false});\n        }\n\n        this.setState({playing});\n    };\n\n    render(): JSX.Element {\n        const title = this.state.playing ? 'Stop' : 'Play';\n\n        if (this.state.playing) {\n            const totalActive = this.props.amplitudes.reduce((total, value) => {\n                const active = value > 0 ? 1 : 0;\n                return total + active;\n            }, 1);\n\n            const balancedGain = 0.1 / totalActive;\n            this.amplitudeNodes.forEach((node, index) => {\n                node.gain.value = balancedGain * this.props.amplitudes[index] / this.props.maxAmplitude;\n            });\n        } else {\n            for (const amplitudeNode of this.amplitudeNodes) {\n                amplitudeNode.gain.value = 0;\n            }\n        }\n\n        return (\n            <div className=\"FrequencyDomainPlayer\">\n                <button onClick={this.togglePlayer}>{title}</button>\n            </div>\n        );\n    };\n}\n\n\nexport default FrequencyDomainPlayer;\n","import {cloneDeep} from 'lodash';\n\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport SineCurve from 'model/SineCurve';\n\nimport FrequencyDomainControl from 'components/FrequencyDomainControl';\nimport FrequencyDomainPlayer from 'components/FrequencyDomainPlayer';\nimport TimePlot from 'components/TimePlot';\n\nimport { addSamples } from 'util/samples';\n\nimport {Sample, TimeValue} from 'model/types';\nimport {\n    Context,\n    Row,\n    ScenarioLink,\n    ScrollToTopOnMount,\n    Topic,\n    Visualization, ZoomControl\n} from 'components/stateless-helpers';\n\nimport {clamp} from '../util/math-hacks';\n\ntype Props = {};\n\ntype State = {\n    amplitudes: number[];\n    zoomLevel: number,\n};\n\nconst MAX_ZOOM_INDEX = 6;\n\nconst frequencies = [250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 2200];\nconst clearFrequencies = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst justOneFrequencies = [0, 0.8, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst harmonicFrequencies = [0, 1, 0, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 0, 0.2, 0, 0, 0 ,0, 0, 0];\nconst buzzFrequencies = [0.9, 1, 0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0];\nconst buzzierFrequencies = [0.3, 0.8, 0.3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2, 0.6, 0.9, 1.0 ,0.6, 0.2, 0];\n\nconst examples: { [index: string] : number[]} = {\n    clearFrequencies,\n    justOneFrequencies,\n    harmonicFrequencies,\n    buzzFrequencies,\n    buzzierFrequencies,\n};\n\nclass SoundsFromSines extends Component<Props, State> {\n    state = {\n        amplitudes: cloneDeep(justOneFrequencies),\n        zoomLevel: 0,\n    };\n\n    onZoom = (increment: number) => {\n        const newZoom = clamp(this.state.zoomLevel + increment, 0, MAX_ZOOM_INDEX);\n        this.setState({zoomLevel: newZoom});\n    }\n\n    onExample = (rawKey: string) => {\n        const key = rawKey + 'Frequencies';\n        if (examples[key]) {\n            this.setState({amplitudes: cloneDeep(examples[key])});\n        } else {\n            this.setState({amplitudes: cloneDeep(justOneFrequencies)});\n        }\n    }\n\n    onChange = (frequencyIndex: number, value: number) => {\n        const amplitudes = [...this.state.amplitudes];\n        amplitudes[frequencyIndex] = value;\n        this.setState({amplitudes});\n    };\n\n    render(): JSX.Element {\n        const plotAmplitude = 10;\n        const controlAmplitude = 1;\n        const samplingRate = 15000;\n\n        const tEnd = 0.020 * (2 ** this.state.zoomLevel);\n\n        const curves: SineCurve[] = this.state.amplitudes.map((amplitude, index) => {\n            return new SineCurve({amplitude, frequency: frequencies[index]});\n        });\n\n        const samples: TimeValue[][] = curves.map((curve: SineCurve) => curve.sample(0, tEnd, samplingRate));\n        const combined: Sample = addSamples(...samples)\n        return (\n            <Topic>\n                <ScrollToTopOnMount />\n                <h2>Sounds from Sines</h2>\n                <Context>\n                    Each slider allows you to change the amplitude of a sine at that frequency. To hear the sine waves\n                    press the Play button below the plot.\n                    <ul>\n                        <li>\n                            The simplest example\n                            <ScenarioLink index=\"justOne\" onClick={this.onExample}>\n                                is a single non-zero amplitude\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            You may want to\n                            <ScenarioLink index=\"clear\" onClick={this.onExample}>\n                                clear all frequencies\n                            </ScenarioLink>\n                        </li>\n                        <li>\n                            A\n                            <ScenarioLink index=\"harmonic\" onClick={this.onExample}>\n                                harmonic series\n                            </ScenarioLink>\n                            is made up of sine curves whose frequencies are integer multiples of a\n                            fundamental frequency. Such as 300 Hz, 600 Hz and 900 Hz in which the first frequency,\n                            300 Hz, is the fundamental frequency.\n                        </li>\n                        <li>\n                            A\n                            <ScenarioLink index=\"buzz\" onClick={this.onExample}>\n                                buzzing sound\n                            </ScenarioLink>\n                            can be produced with sine curves whose frequencies are close together. In this case the\n                            silent part of the buzz is the roughly 7 milliseconds in which the waves mostly cancel out.\n                            If you make the quiet part longer and increase the amplitude of the loud part then the sound\n                            becomes even more\n                            <ScenarioLink index=\"buzzier\" onClick={this.onExample}>\n                                ticky\n                            </ScenarioLink>\n                        </li>\n                    </ul>\n                </Context>\n                <Visualization>\n                    <TimePlot values={combined} width={800} height={400} minY={-plotAmplitude} maxY={plotAmplitude}/>\n                    <Row>\n                        <FrequencyDomainPlayer amplitudes={this.state.amplitudes} frequencies={frequencies} maxAmplitude={controlAmplitude}/>\n                        <button onClick={() => this.onExample('clear') }>Clear</button>\n                        <ZoomControl current={this.state.zoomLevel} min={0} max={MAX_ZOOM_INDEX} onZoom={this.onZoom} />\n                    </Row>\n                    <FrequencyDomainControl\n                        amplitudes={this.state.amplitudes}\n                        frequencies={frequencies}\n                        maxAmplitude={controlAmplitude}\n                        onChange={this.onChange}\n                    />\n                </Visualization>\n                <Context>\n                    <h3>Things to Try</h3>\n                    <li>\n                        Can you make a higher pitched\n                        <ScenarioLink index=\"harmonic\" onClick={this.onExample}>\n                            harmonic\n                        </ScenarioLink>?\n                    </li>\n                    <li>\n                       You can make a harmonic that is smooth and looks like a saw tooth by decreasing the amplitudes\n                        as the frequencies increase. Or you can make the curve smoother and less toothy by keeping the\n                        amplitudes the same. How does that change the sound? Which do you find more appealing?\n                    </li>\n                    <li>Try making interesting shapes with the sound off. Can you guess what they will sound like?</li>\n                    <h3>Why Bother?</h3>\n                    There is a lot more to learn, but these basic principles are key to understanding acoustics and even\n                    music theory.\n                    <div>\n                    </div>\n                    <h3>Next Steps</h3>\n                    Creating interesting signals is just one part of the DSP toolbox. Sometimes you have a signal but\n                    need to modify with <Link to=\"/convolution=steps\">convolution</Link>\n                </Context>\n            </Topic>\n        );\n    };\n}\n\nexport default SoundsFromSines;\n","import React, { Component } from 'react';\nimport {\n    HashRouter,\n    Switch,\n    Route,\n} from 'react-router-dom';\n\nimport About from 'content/About';\nimport SimpleAddition from 'content/SimpleAddition';\n\n\nimport './App.scss';\nimport TopNav from 'components/TopNav';\nimport {LabeledPath} from 'model/types';\nimport ConvolutionSteps from './content/ConvolutionSteps/ConvolutionSteps';\nimport Topics from 'content/Topics';\nimport SumOfManySines from 'content/SumOfManySines';\nimport UnitCircleAndCurves from 'content/UnitCircleAndCurves/UnitCircleAndCurves';\nimport SineOverTime from 'content/SineOverTime';\nimport SoundsFromSines from \"./content/SoundsFromSines\";\n\ntype Props = {};\n\ntype State = {};\n\nconst home: LabeledPath = {label: 'DSP Playground', path: '/'};\nconst links = [\n    {label: 'Topics', path: '/topics' },\n    {label: 'About', path: '/about' },\n];\nconst navProps = {home, links};\n\nclass App extends Component<Props, State> {\n\n\n    render(): JSX.Element {\n        return (\n            <div className=\"App\">\n                <HashRouter basename=\"/\">\n                    <TopNav {...navProps} centerText=\"\"/>\n                    <Switch>\n                        <Route path=\"/unit-circle\">\n                            <UnitCircleAndCurves />\n                        </Route>\n                        <Route path=\"/sine-over-time\">\n                            <SineOverTime />\n                        </Route>\n                        <Route path=\"/add-sines\">\n                            <SimpleAddition />\n                        </Route>\n                        <Route path=\"/sum-many-sines\">\n                            <SumOfManySines />\n                        </Route>\n                        <Route path=\"/sounds-from-sines\">\n                            <SoundsFromSines/>\n                        </Route>\n                        <Route path=\"/convolution=steps\">\n                            <ConvolutionSteps/>\n                        </Route>\n                        <Route path=\"/about\">\n                            <About />\n                        </Route>\n                        <Route path=\"/topics\">\n                            <Topics />\n                        </Route>\n                        <Route path=\"/\">\n                            <Topics />\n                        </Route>\n                    </Switch>\n\n                    <TopNav {...navProps} centerText=\"&copy; 2021 - WoundedPixels.com build date 05-15-21\" />\n                </HashRouter>\n            </div>\n        );\n    };\n}\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}